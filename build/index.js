'use strict';var react=require('react'),U=require('fast-deep-equal');function _interopDefault(e){return e&&e.__esModule?e:{default:e}}var U__default=/*#__PURE__*/_interopDefault(U);var l=class e{constructor(){this.traces=[];}static empty(){return new e}add(t){let r=new e;return r.traces=[...this.traces,t],r}*[Symbol.iterator](){for(let t of this.traces)yield t;}};var p=class e{constructor(t,r){this.message=t,this.time=r;}static from(t,r){return new e(t,r)}read(){return this.message}at(){return this.time}};var h=Symbol("JsMonadSomeSymbol"),T,f=class e{constructor(t){this[T]=true;this.value=t;}static[(T=h,Symbol.hasInstance)](t){return y(t)}static of(t){return new e(t)}bind(t){return t(this.value)}unwrap(){return this.value}map(t){let r=t(this.value);return e.of(r)}};function y(e){return e&&e[h]===true}var d=Symbol("JsMonadNoneSymbol"),v,x=class e{constructor(){this[v]=true;}static[(v=d,Symbol.hasInstance)](t){return C(t)}static of(){return new e}bind(t){return this}unwrap(){throw new Error("Value of None cannot be unwrapped")}map(t){return this}};function C(e){return e&&e[d]===true}var c=class e{constructor(){this.contexts={};}static empty(){return new e}get(t){return this.contexts[t]?f.of(this.contexts[t]):x.of()}add(t,r){let o=new e;return o.contexts={...this.contexts},o.contexts[t]=r,o}remove(t){let r=new e;return r.contexts={...this.contexts},delete r.contexts[t],r}*[Symbol.iterator](){for(let t in this.contexts)yield this.contexts[t];}};var g=Symbol("JsMonadFailureSymbol"),R,a=class e{constructor(t,r,o,n,i){this[R]=true;this.message=t,this.name="Failure",this.code=r,this.traces=o,this.contexts=n,this.previous=i;}static[(R=g,Symbol.hasInstance)](t){return w(t)}static dueTo(t,r,o,n,i,m){return i=i??l.empty(),n?i.add(n):i.add(p.from(t,Date.now())),m=m??c.empty(),new e(t,r,i,m,o||null)}bind(t){return this}map(t){return this}lift(t){return this}unwrap(){throw new Error("Value of Failure can not be unwrapped")}getTraces(){return this.traces}withTrace(t){return this.traces.add(t),this}withContext(t,r){return this.contexts.add(t,r),this}getContext(t){return this.contexts.get(t)}getContexts(){return this.contexts}clearContext(t){return this.contexts.remove(t),this}};function w(e){return e&&e[g]===true}var S=Symbol("JsMonadSuccessSymbol"),b,s=class e{constructor(t,r,o){this[b]=true;this.value=t,this.traces=r,this.contexts=o;}static[(b=S,Symbol.hasInstance)](t){return A(t)}static of(t,r,o){return new e(t,r??l.empty(),o??c.empty())}bind(t){return t(this.value)}lift(t){return new e(t,this.traces,this.contexts)}map(t){return new e(t(this.value),this.traces,this.contexts)}unwrap(){return this.value}getTraces(){return this.traces}withTrace(t){return this.traces.add(t),this}withContext(t,r){return this.contexts.add(t,r),this}getContext(t){return this.contexts.get(t)}getContexts(){return this.contexts}clearContext(t){return this.contexts.remove(t),this}};function A(e){return e&&e[S]===true}var E=Symbol("JsMonadAwaitingSymbol"),O;O=E;var u=class{constructor(){this[O]=true;}};function N(e){return e&&e[E]===true}function J(e,{onSuccess:t,onFailure:r}){let o=react.useRef(new u);react.useEffect(()=>{let n=o.current,i=n instanceof u&&(e instanceof s||e instanceof a)||n instanceof s&&e instanceof a||n instanceof a&&e instanceof s,m=e instanceof s&&n instanceof s&&!U__default.default(n.unwrap(),e.unwrap());(i||m)&&(e instanceof s&&t&&t(e.unwrap()),e instanceof a&&r&&r(e.unwrap())),o.current=e;},[e,t,r]);}exports.Awaiting=u;exports.ContextCollection=c;exports.Failure=a;exports.None=x;exports.Some=f;exports.Success=s;exports.TraceCollection=l;exports.TraceCommon=p;exports.isAwaiting=N;exports.isFailure=w;exports.isNone=C;exports.isSome=y;exports.isSuccess=A;exports.useEffectAsyncResult=J;//# sourceMappingURL=index.js.map
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9tb25hZC90cmFjZS90cmFjZS1jb2xsZWN0aW9uLnRzIiwiLi4vc3JjL21vbmFkL3RyYWNlL3RyYWNlLWNvbW1vbi50cyIsIi4uL3NyYy9tb25hZC9tb25hZHMvb3B0aW9uYWwvc29tZS50cyIsIi4uL3NyYy9tb25hZC9tb25hZHMvb3B0aW9uYWwvbm9uZS50cyIsIi4uL3NyYy9tb25hZC9jb250ZXh0L2NvbnRleHQtY29sbGVjdGlvbi50cyIsIi4uL3NyYy9tb25hZC9tb25hZHMvZWl0aGVyL2ZhaWx1cmUudHMiLCIuLi9zcmMvbW9uYWQvbW9uYWRzL2VpdGhlci9zdWNjZXNzLnRzIiwiLi4vc3JjL21vbmFkL2F3YWl0aW5nLnRzIiwiLi4vc3JjL21vbmFkL2hvb2tzL3VzZS1lZmZlY3QtYXN5bmMtcmVzdWx0LnRzeCJdLCJuYW1lcyI6WyJUcmFjZUNvbGxlY3Rpb24iLCJfVHJhY2VDb2xsZWN0aW9uIiwidHJhY2UiLCJuZXdDb2xsZWN0aW9uIiwiVHJhY2VDb21tb24iLCJfVHJhY2VDb21tb24iLCJtZXNzYWdlIiwidGltZSIsIlNvbWVTeW1ib2wiLCJfYSIsIlNvbWUiLCJfU29tZSIsInZhbHVlIiwib2JqIiwiaXNTb21lIiwiZm4iLCJuZXdWYWx1ZSIsIk5vbmVTeW1ib2wiLCJOb25lIiwiX05vbmUiLCJpc05vbmUiLCJDb250ZXh0Q29sbGVjdGlvbiIsIl9Db250ZXh0Q29sbGVjdGlvbiIsImtleSIsImNvbnRleHQiLCJGYWlsdXJlU3ltYm9sIiwiRmFpbHVyZSIsIl9GYWlsdXJlIiwiY29kZSIsInRyYWNlcyIsImNvbnRleHRzIiwicHJldmlvdXMiLCJpc0ZhaWx1cmUiLCJTdWNjZXNzU3ltYm9sIiwiU3VjY2VzcyIsIl9TdWNjZXNzIiwiaXNTdWNjZXNzIiwiQXdhaXRpbmdTeW1ib2wiLCJBd2FpdGluZyIsImlzQXdhaXRpbmciLCJ1c2VFZmZlY3RBc3luY1Jlc3VsdCIsInJlc3VsdCIsIm9uU3VjY2VzcyIsIm9uRmFpbHVyZSIsInByZXZpb3VzUmVmIiwidXNlUmVmIiwidXNlRWZmZWN0IiwiaGFzU3RhdHVzQ2hhbmdlZCIsImhhc1ZhbHVlQ2hhbmdlZCIsImlzRXF1YWwiXSwibWFwcGluZ3MiOiJxTEFJYUEsSUFBQUEsQ0FBQUEsQ0FBTixNQUFNQyxDQUFrQyxDQUdyQyxhQUFjLENBRnRCLElBQUEsQ0FBVSxPQUFrQixHQUVMLENBRXZCLE9BQWMsS0FBQSxFQUF5QixDQUNyQyxPQUFPLElBQUlBLENBQ2IsQ0FFTyxHQUFBLENBQUlDLENBQStCLENBQUEsQ0FDeEMsSUFBTUMsQ0FBQUEsQ0FBZ0IsSUFBSUYsQ0FDMUIsQ0FBQSxPQUFBRSxFQUFjLE1BQVMsQ0FBQSxDQUFDLEdBQUcsSUFBSyxDQUFBLE1BQUEsQ0FBUUQsQ0FBSyxDQUFBLENBQ3RDQyxDQUNULENBRUEsRUFBUyxNQUFPLENBQUEsUUFBUSxHQUFxQixDQUMzQyxJQUFBLElBQVdELEtBQVMsSUFBSyxDQUFBLE1BQUEsQ0FDdkIsTUFBTUEsRUFFVixDQUNGLE1DckJhRSxDQUFOLENBQUEsTUFBTUMsQ0FBNkIsQ0FJaEMsV0FBQSxDQUFZQyxFQUFpQkMsQ0FBYyxDQUFBLENBQ2pELEtBQUssT0FBVUQsQ0FBQUEsQ0FBQUEsQ0FDZixLQUFLLElBQU9DLENBQUFBLEVBQ2QsQ0FFQSxPQUFjLElBQUEsQ0FBS0QsRUFBaUJDLENBQTJCLENBQUEsQ0FDN0QsT0FBTyxJQUFJRixDQUFZQyxDQUFBQSxDQUFBQSxDQUFTQyxDQUFJLENBQ3RDLENBRU8sTUFBZSxDQUNwQixPQUFPLEtBQUssT0FDZCxDQUVPLEVBQWEsRUFBQSxDQUNsQixPQUFPLElBQUEsQ0FBSyxJQUNkLENBQ0YsTUNuQk1DLENBQWEsQ0FBQSxNQUFBLENBQU8sbUJBQW1CLENBSjdDQyxDQUFBQSxDQUFBQSxDQU1hQyxDQUFOLENBQUEsTUFBTUMsQ0FBK0IsQ0FTbEMsWUFBWUMsQ0FBVSxDQUFBLENBTjlCLEtBQUNILENBQWMsQ0FBQSxDQUFBLElBQUEsQ0FPYixLQUFLLEtBQVFHLENBQUFBLEVBQ2YsQ0FOQSxRQUZDSCxDQUFBQSxDQUFBRCxFQUVPLE1BQU8sQ0FBQSxXQUFBLEdBQWFLLENBQW1CLENBQUEsQ0FDN0MsT0FBT0MsQ0FBT0QsQ0FBQUEsQ0FBRyxDQUNuQixDQU1BLE9BQU8sRUFBQSxDQUFNRCxFQUFtQixDQUM5QixPQUFPLElBQUlELENBQUtDLENBQUFBLENBQUssQ0FDdkIsQ0FFQSxJQUFBLENBQVFHLENBQTRDLENBQUEsQ0FDbEQsT0FBT0EsQ0FBQUEsQ0FBRyxLQUFLLEtBQUssQ0FDdEIsQ0FFQSxNQUFZLEVBQUEsQ0FDVixPQUFPLElBQUssQ0FBQSxLQUNkLENBRUEsR0FBQSxDQUFPQSxDQUFrQyxDQUFBLENBQ3ZDLElBQU1DLENBQVdELENBQUFBLENBQUFBLENBQUcsS0FBSyxLQUFLLENBQUEsQ0FDOUIsT0FBT0osQ0FBSyxDQUFBLEVBQUEsQ0FBR0ssQ0FBUSxDQUN6QixDQUNGLEVBRU8sU0FBU0YsQ0FBQUEsQ0FDZEQsRUFDZ0IsQ0FDaEIsT0FBT0EsR0FBUUEsQ0FBZ0JMLENBQUFBLENBQVUsQ0FBTSxHQUFBLElBQ2pELENDcENBLElBQU1TLEVBQWEsTUFBTyxDQUFBLG1CQUFtQixFQUw3Q1IsQ0FPYVMsQ0FBQUEsQ0FBQUEsQ0FBTixNQUFNQyxDQUFnQyxDQUF0QyxXQUNMLEVBQUEsQ0FBQSxJQUFBLENBQUNWLENBQWMsQ0FBQSxDQUFBLEtBQUEsQ0FFZixRQUZDQSxDQUFBUSxDQUFBQSxDQUFBQSxDQUVPLE9BQU8sV0FBVyxFQUFBLENBQUVKLEVBQW1CLENBQzdDLE9BQU9PLENBQU9QLENBQUFBLENBQUcsQ0FDbkIsQ0FFQSxPQUFPLEVBQVcsRUFBQSxDQUNoQixPQUFPLElBQUlNLENBQ2IsQ0FFQSxJQUFLSixDQUFBQSxDQUFBQSxDQUE2QyxDQUNoRCxPQUFPLElBQ1QsQ0FFQSxNQUFnQixFQUFBLENBQ2QsTUFBTSxJQUFJLEtBQUEsQ0FBTSxtQ0FBbUMsQ0FDckQsQ0FFQSxHQUFPQSxDQUFBQSxDQUFBQSxDQUErQixDQUNwQyxPQUFPLElBQ1QsQ0FDRixFQUVPLFNBQVNLLENBQ2RQLENBQUFBLENBQUFBLENBQ2EsQ0FDYixPQUFPQSxDQUFBQSxFQUFRQSxDQUFhSSxDQUFBQSxDQUFVLENBQU0sR0FBQSxJQUM5QyxDQzdCYUksSUFBQUEsQ0FBQUEsQ0FBTixNQUFNQyxDQUFzQyxDQUE1QyxjQUNMLElBQVEsQ0FBQSxRQUFBLENBQXVDLEdBQUMsQ0FFaEQsT0FBTyxLQUFBLEVBQTJCLENBQ2hDLE9BQU8sSUFBSUEsQ0FDYixDQUVBLEdBQUEsQ0FBSUMsRUFBc0MsQ0FDeEMsT0FBTyxLQUFLLFFBQVNBLENBQUFBLENBQUcsRUFBSWIsQ0FBSyxDQUFBLEVBQUEsQ0FBRyxLQUFLLFFBQVNhLENBQUFBLENBQUcsQ0FBQyxDQUFJTCxDQUFBQSxDQUFBQSxDQUFLLEVBQUcsRUFDcEUsQ0FFQSxHQUFBLENBQUlLLEVBQWFDLENBQXFDLENBQUEsQ0FDcEQsSUFBTXJCLENBQWdCLENBQUEsSUFBSW1CLEVBQzFCLE9BQUFuQixDQUFBQSxDQUFjLFFBQVcsQ0FBQSxDQUFFLEdBQUcsSUFBQSxDQUFLLFFBQVMsQ0FDNUNBLENBQUFBLENBQUFBLENBQWMsU0FBU29CLENBQUcsQ0FBQSxDQUFJQyxFQUN2QnJCLENBQ1QsQ0FFQSxNQUFPb0IsQ0FBQUEsQ0FBQUEsQ0FBZ0MsQ0FDckMsSUFBTXBCLEVBQWdCLElBQUltQixDQUFBQSxDQUMxQixPQUFBbkIsQ0FBYyxDQUFBLFFBQUEsQ0FBVyxDQUFFLEdBQUcsSUFBQSxDQUFLLFFBQVMsQ0FDNUMsQ0FBQSxPQUFPQSxFQUFjLFFBQVNvQixDQUFBQSxDQUFHLEVBQzFCcEIsQ0FDVCxDQUVBLEVBQUUsTUFBTyxDQUFBLFFBQVEsQ0FBdUIsRUFBQSxDQUN0QyxJQUFXb0IsSUFBQUEsQ0FBQUEsSUFBTyxLQUFLLFFBQ3JCLENBQUEsTUFBTSxLQUFLLFFBQVNBLENBQUFBLENBQUcsRUFFM0IsQ0FDRixFQ3pCTUUsSUFBQUEsQ0FBQUEsQ0FBZ0IsTUFBTyxDQUFBLHNCQUFzQixFQVhuRGhCLENBYWFpQixDQUFBQSxDQUFBQSxDQUFOLE1BQU1DLENBQXdDLENBYzNDLFlBQ05yQixDQUNBc0IsQ0FBQUEsQ0FBQUEsQ0FDQUMsQ0FDQUMsQ0FBQUEsQ0FBQUEsQ0FDQUMsQ0FDQSxDQUFBLENBWkYsS0FBQ3RCLENBQWlCLENBQUEsQ0FBQSxJQUFBLENBYWhCLEtBQUssT0FBVUgsQ0FBQUEsQ0FBQUEsQ0FDZixLQUFLLElBQU8sQ0FBQSxTQUFBLENBQ1osSUFBSyxDQUFBLElBQUEsQ0FBT3NCLENBQ1osQ0FBQSxJQUFBLENBQUssT0FBU0MsQ0FDZCxDQUFBLElBQUEsQ0FBSyxTQUFXQyxDQUNoQixDQUFBLElBQUEsQ0FBSyxTQUFXQyxFQUNsQixDQWpCQSxRQUZDdEIsQ0FBQUEsQ0FBQWdCLENBRU8sQ0FBQSxNQUFBLENBQU8sYUFBYVosQ0FBQUEsQ0FBQUEsQ0FBbUIsQ0FDN0MsT0FBT21CLENBQUFBLENBQVVuQixDQUFHLENBQ3RCLENBaUJBLE9BQU8sS0FBQSxDQUNMUCxDQUNBc0IsQ0FBQUEsQ0FBQUEsQ0FDQUcsRUFDQTdCLENBQ0EyQixDQUFBQSxDQUFBQSxDQUNBQyxFQUNTLENBRVQsT0FBQUQsRUFBU0EsQ0FBVTdCLEVBQUFBLENBQUFBLENBQWdCLEtBQU0sRUFBQSxDQUNyQ0UsQ0FDRjJCLENBQUFBLENBQUFBLENBQU8sSUFBSTNCLENBQUssQ0FBQSxDQUdoQjJCLEVBQU8sR0FBSXpCLENBQUFBLENBQUFBLENBQVksS0FBS0UsQ0FBUyxDQUFBLElBQUEsQ0FBSyxLQUFLLENBQUMsRUFHbER3QixDQUFXQSxDQUFBQSxDQUFBQSxFQUFZVCxFQUFrQixLQUFNLEVBQUEsQ0FDeEMsSUFBSU0sQ0FDVHJCLENBQUFBLENBQUFBLENBQ0FzQixDQUNBQyxDQUFBQSxDQUFBQSxDQUNBQyxDQUNBQyxDQUFBQSxDQUFBQSxFQUFzQixJQUN4QixDQUNGLENBRUEsS0FBS2hCLENBQW9ELENBQUEsQ0FDdkQsT0FBTyxJQUNULENBRUEsR0FBSUEsQ0FBQUEsQ0FBQUEsQ0FBNEMsQ0FDOUMsT0FBTyxJQUNULENBRUEsSUFBQSxDQUFLSCxFQUE2QixDQUNoQyxPQUFPLElBQ1QsQ0FFQSxNQUFBLEVBQWdCLENBQ2QsTUFBTSxJQUFJLEtBQUEsQ0FBTSx1Q0FBdUMsQ0FDekQsQ0FFQSxXQUFvQixDQUNsQixPQUFPLEtBQUssTUFDZCxDQUVBLFVBQVVWLENBQTZCLENBQUEsQ0FDckMsWUFBSyxNQUFPLENBQUEsR0FBQSxDQUFJQSxDQUFLLENBQ2QsQ0FBQSxJQUNULENBRUEsV0FBWXFCLENBQUFBLENBQUFBLENBQWFDLENBQWlDLENBQUEsQ0FDeEQsT0FBSyxJQUFBLENBQUEsUUFBQSxDQUFTLElBQUlELENBQUtDLENBQUFBLENBQU8sRUFDdkIsSUFDVCxDQUVBLFdBQVdELENBQXNDLENBQUEsQ0FDL0MsT0FBTyxJQUFBLENBQUssUUFBUyxDQUFBLEdBQUEsQ0FBSUEsQ0FBRyxDQUM5QixDQUVBLGFBQXdCLENBQ3RCLE9BQU8sS0FBSyxRQUNkLENBRUEsWUFBYUEsQ0FBQUEsQ0FBQUEsQ0FBNEIsQ0FDdkMsT0FBQSxJQUFBLENBQUssU0FBUyxNQUFPQSxDQUFBQSxDQUFHLEVBQ2pCLElBQ1QsQ0FDRixFQUVPLFNBQVNTLENBQUFBLENBQWFuQixFQUFpRCxDQUM1RSxPQUFPQSxHQUFRQSxDQUFnQlksQ0FBQUEsQ0FBYSxJQUFNLElBQ3BELEtDekdNUSxDQUFnQixDQUFBLE1BQUEsQ0FBTyxzQkFBc0IsQ0FBQSxDQVZuRHhCLENBWWF5QixDQUFBQSxDQUFBQSxDQUFOLE1BQU1DLENBQWdDLENBVW5DLFlBQVl2QixDQUFVaUIsQ0FBQUEsQ0FBQUEsQ0FBZ0JDLEVBQW9CLENBTmxFLElBQUEsQ0FBQ3JCLENBQWlCLENBQUEsQ0FBQSxJQUFBLENBT2hCLElBQUssQ0FBQSxLQUFBLENBQVFHLEVBQ2IsSUFBSyxDQUFBLE1BQUEsQ0FBU2lCLEVBQ2QsSUFBSyxDQUFBLFFBQUEsQ0FBV0MsRUFDbEIsQ0FSQSxRQUZDckIsQ0FBQXdCLENBQUFBLENBQUFBLENBRU8sTUFBTyxDQUFBLFdBQUEsR0FBYXBCLENBQW1CLENBQUEsQ0FDN0MsT0FBT3VCLENBQVV2QixDQUFBQSxDQUFHLENBQ3RCLENBUUEsT0FBTyxHQUFHRCxDQUFZaUIsQ0FBQUEsQ0FBQUEsQ0FBd0JDLEVBQTRCLENBQ3hFLE9BQU8sSUFBSUssQ0FDVHZCLENBQUFBLENBQUFBLENBQ0FpQixHQUFVN0IsQ0FBZ0IsQ0FBQSxLQUFBLEVBQzFCOEIsQ0FBQUEsQ0FBQUEsRUFBWVQsQ0FBa0IsQ0FBQSxLQUFBLEVBQ2hDLENBQ0YsQ0FFQSxLQUFLTixDQUF3QyxDQUFBLENBQzNDLE9BQU9BLENBQUcsQ0FBQSxJQUFBLENBQUssS0FBSyxDQUN0QixDQUVBLElBQUEsQ0FBS0gsRUFBdUIsQ0FDMUIsT0FBTyxJQUFJdUIsQ0FBUXZCLENBQUFBLENBQUFBLENBQU8sS0FBSyxNQUFRLENBQUEsSUFBQSxDQUFLLFFBQVEsQ0FDdEQsQ0FFQSxHQUFBLENBQUlHLEVBQW9DLENBQ3RDLE9BQU8sSUFBSW9CLENBQVFwQixDQUFBQSxDQUFBQSxDQUFHLEtBQUssS0FBSyxDQUFBLENBQUcsS0FBSyxNQUFRLENBQUEsSUFBQSxDQUFLLFFBQVEsQ0FDL0QsQ0FFQSxRQUFZLENBQ1YsT0FBTyxLQUFLLEtBQ2QsQ0FFQSxTQUFvQixFQUFBLENBQ2xCLE9BQU8sSUFBQSxDQUFLLE1BQ2QsQ0FFQSxTQUFBLENBQVViLEVBQXlCLENBQ2pDLE9BQUEsSUFBQSxDQUFLLE9BQU8sR0FBSUEsQ0FBQUEsQ0FBSyxDQUNkLENBQUEsSUFDVCxDQUVBLFdBQUEsQ0FBWXFCLEVBQWFDLENBQTZCLENBQUEsQ0FDcEQsWUFBSyxRQUFTLENBQUEsR0FBQSxDQUFJRCxFQUFLQyxDQUFPLENBQUEsQ0FDdkIsSUFDVCxDQUVBLFVBQVdELENBQUFBLENBQUFBLENBQXNDLENBQy9DLE9BQU8sSUFBQSxDQUFLLFNBQVMsR0FBSUEsQ0FBQUEsQ0FBRyxDQUM5QixDQUVBLFdBQUEsRUFBd0IsQ0FDdEIsT0FBTyxJQUFBLENBQUssUUFDZCxDQUVBLFlBQUEsQ0FBYUEsRUFBd0IsQ0FDbkMsT0FBQSxJQUFBLENBQUssU0FBUyxNQUFPQSxDQUFBQSxDQUFHLENBQ2pCLENBQUEsSUFDVCxDQUNGLEVBRU8sU0FBU2EsQ0FDZHZCLENBQUFBLENBQUFBLENBQ21CLENBQ25CLE9BQU9BLENBQUFBLEVBQVFBLEVBQW1Cb0IsQ0FBYSxDQUFBLEdBQU0sSUFDdkQsQ0NoRkEsSUFBTUksQ0FBQUEsQ0FBaUIsT0FBTyx1QkFBdUIsQ0FBQSxDQUpyRDVCLEVBV0dBLENBQUE0QixDQUFBQSxDQUFBQSxLQUZVQyxDQUFOLENBQUEsS0FBb0MsQ0FBcEMsV0FBQSxFQUFBLENBRUwsSUFBQzdCLENBQUFBLENBQUFBLENBQUFBLENBQWtCLE1BQ3JCLEVBR08sU0FBUzhCLEVBQWMxQixDQUFzQyxDQUFBLENBQ2xFLE9BQU9BLENBQVFBLEVBQUFBLENBQUFBLENBQWlCd0IsQ0FBYyxDQUFNLEdBQUEsSUFDdEQsQ0NMTyxTQUFTRyxDQUNkQyxDQUFBQSxDQUFBQSxDQUNBLENBQUUsU0FBQUMsQ0FBQUEsQ0FBQUEsQ0FBVyxVQUFBQyxDQUFVLENBQUEsQ0FDakIsQ0FDTixJQUFNQyxDQUFBQSxDQUFjQyxZQUF1QixDQUFBLElBQUlQLENBQVUsQ0FBQSxDQUV6RFEsZ0JBQVUsSUFBTSxDQUNkLElBQU1mLENBQVdhLENBQUFBLENBQUFBLENBQVksUUFFdkJHLENBRUZoQixDQUFBQSxDQUFBQSxZQUFvQk8sQ0FDbkJHLEdBQUFBLENBQUFBLFlBQWtCUCxDQUFXTyxFQUFBQSxDQUFBQSxZQUFrQmYsSUFJOUNLLENBQW9CRyxZQUFBQSxDQUFBQSxFQUFXTyxhQUFrQmYsQ0FHakRLLEVBQUFBLENBQUFBLFlBQW9CTCxHQUFXZSxDQUFrQlAsWUFBQUEsQ0FBQUEsQ0FNakRjLENBQ0pQLENBQUFBLENBQUFBLFlBQWtCUCxDQUNsQkgsRUFBQUEsQ0FBQUEsWUFBb0JHLEdBQ3BCLENBQUNlLGtCQUFBQSxDQUFRbEIsRUFBUyxNQUFPLEVBQUEsQ0FBR1UsRUFBTyxNQUFPLEVBQUMsQ0FFekNNLENBQUFBLENBQUFBLENBQUFBLEVBQW9CQyxDQUNsQlAsSUFBQUEsQ0FBQUEsWUFBa0JQLEdBQVdRLENBQy9CQSxFQUFBQSxDQUFBQSxDQUFVRCxFQUFPLE1BQU8sRUFBQyxFQUV2QkEsQ0FBa0JmLFlBQUFBLENBQUFBLEVBQVdpQixDQUMvQkEsRUFBQUEsQ0FBQUEsQ0FBVUYsQ0FBTyxDQUFBLE1BQUEsRUFBUSxDQUk3QkcsQ0FBQUEsQ0FBQUEsQ0FBQUEsQ0FBWSxRQUFVSCxFQUN4QixDQUFBLENBQUcsQ0FBQ0EsQ0FBUUMsQ0FBQUEsQ0FBQUEsQ0FBV0MsQ0FBUyxDQUFDLEVBQ25DIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gSW1wbGVtZW50IHRoZSBUcmFjZUNvbGxlY3Rpb24gY2xhc3NcbmltcG9ydCB7IFRyYWNlcyB9IGZyb20gXCJAL21vbmFkL3RyYWNlL3RyYWNlc1wiO1xuaW1wb3J0IHsgVHJhY2UgfSBmcm9tIFwiQC9tb25hZC90cmFjZS90cmFjZVwiO1xuXG5leHBvcnQgY2xhc3MgVHJhY2VDb2xsZWN0aW9uIGltcGxlbWVudHMgVHJhY2VzIHtcbiAgcHJvdGVjdGVkIHRyYWNlczogVHJhY2VbXSA9IFtdO1xuXG4gIHByaXZhdGUgY29uc3RydWN0b3IoKSB7fVxuXG4gIHB1YmxpYyBzdGF0aWMgZW1wdHkoKTogVHJhY2VDb2xsZWN0aW9uIHtcbiAgICByZXR1cm4gbmV3IFRyYWNlQ29sbGVjdGlvbigpO1xuICB9XG5cbiAgcHVibGljIGFkZCh0cmFjZTogVHJhY2UpOiBUcmFjZUNvbGxlY3Rpb24ge1xuICAgIGNvbnN0IG5ld0NvbGxlY3Rpb24gPSBuZXcgVHJhY2VDb2xsZWN0aW9uKCk7XG4gICAgbmV3Q29sbGVjdGlvbi50cmFjZXMgPSBbLi4udGhpcy50cmFjZXMsIHRyYWNlXTtcbiAgICByZXR1cm4gbmV3Q29sbGVjdGlvbjtcbiAgfVxuXG4gIHB1YmxpYyAqW1N5bWJvbC5pdGVyYXRvcl0oKTogSXRlcmF0b3I8VHJhY2U+IHtcbiAgICBmb3IgKGNvbnN0IHRyYWNlIG9mIHRoaXMudHJhY2VzKSB7XG4gICAgICB5aWVsZCB0cmFjZTtcbiAgICB9XG4gIH1cbn1cbiIsIi8vIEltcGxlbWVudCB0aGUgVHJhY2VDb21tb24gY2xhc3NcbmltcG9ydCB7IFRyYWNlIH0gZnJvbSBcIkAvbW9uYWQvdHJhY2UvdHJhY2VcIjtcblxuZXhwb3J0IGNsYXNzIFRyYWNlQ29tbW9uIGltcGxlbWVudHMgVHJhY2Uge1xuICBwcml2YXRlIHJlYWRvbmx5IG1lc3NhZ2U6IHN0cmluZztcbiAgcHJpdmF0ZSByZWFkb25seSB0aW1lOiBudW1iZXI7XG5cbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcsIHRpbWU6IG51bWJlcikge1xuICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgdGhpcy50aW1lID0gdGltZTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgZnJvbShtZXNzYWdlOiBzdHJpbmcsIHRpbWU6IG51bWJlcik6IFRyYWNlQ29tbW9uIHtcbiAgICByZXR1cm4gbmV3IFRyYWNlQ29tbW9uKG1lc3NhZ2UsIHRpbWUpO1xuICB9XG5cbiAgcHVibGljIHJlYWQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5tZXNzYWdlO1xuICB9XG5cbiAgcHVibGljIGF0KCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMudGltZTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgT3B0aW9uYWwgfSBmcm9tIFwiQC9tb25hZC9vcHRpb25hbFwiO1xuaW1wb3J0IHsgQXN5bmNPcHRpb25hbFJlc3VsdCwgT3B0aW9uYWxSZXN1bHQgfSBmcm9tIFwiQC9tb25hZC9yZXN1bHRcIjtcbmltcG9ydCB7IGlzTm9uZSwgTm9uZSB9IGZyb20gXCJAL21vbmFkL21vbmFkcy9vcHRpb25hbC9ub25lXCI7XG5cbmNvbnN0IFNvbWVTeW1ib2wgPSBTeW1ib2woXCJKc01vbmFkU29tZVN5bWJvbFwiKTtcblxuZXhwb3J0IGNsYXNzIFNvbWU8VD4gaW1wbGVtZW50cyBPcHRpb25hbDxUPiB7XG4gIHByaXZhdGUgcmVhZG9ubHkgdmFsdWU6IFQ7XG5cbiAgW1NvbWVTeW1ib2xdID0gdHJ1ZTtcblxuICBzdGF0aWMgW1N5bWJvbC5oYXNJbnN0YW5jZV0ob2JqOiBhbnkpOiBib29sZWFuIHtcbiAgICByZXR1cm4gaXNTb21lKG9iaik7XG4gIH1cblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKHZhbHVlOiBUKSB7XG4gICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICB9XG5cbiAgc3RhdGljIG9mPFQ+KHZhbHVlOiBUKTogU29tZTxUPiB7XG4gICAgcmV0dXJuIG5ldyBTb21lKHZhbHVlKTtcbiAgfVxuXG4gIGJpbmQ8VT4oZm46ICh2YWx1ZTogVCkgPT4gT3B0aW9uYWw8VT4pOiBPcHRpb25hbDxVPiB7XG4gICAgcmV0dXJuIGZuKHRoaXMudmFsdWUpO1xuICB9XG5cbiAgdW53cmFwKCk6IFQge1xuICAgIHJldHVybiB0aGlzLnZhbHVlO1xuICB9XG5cbiAgbWFwPFU+KGZuOiAodmFsdWU6IFQpID0+IFUpOiBPcHRpb25hbDxVPiB7XG4gICAgY29uc3QgbmV3VmFsdWUgPSBmbih0aGlzLnZhbHVlKTtcbiAgICByZXR1cm4gU29tZS5vZihuZXdWYWx1ZSk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzU29tZTxUPihcbiAgb2JqOiBPcHRpb25hbFJlc3VsdDxhbnk+IHwgQXN5bmNPcHRpb25hbFJlc3VsdDxhbnk+LFxuKTogb2JqIGlzIFNvbWU8VD4ge1xuICByZXR1cm4gb2JqICYmIChvYmogYXMgU29tZTxUPilbU29tZVN5bWJvbF0gPT09IHRydWU7XG59XG4iLCIvLyBEZWZpbmUgdGhlIE5vbmUgY2xhc3MgaW1wbGVtZW50aW5nIHRoZSBPcHRpb25hbCBpbnRlcmZhY2VcbmltcG9ydCB7IE9wdGlvbmFsIH0gZnJvbSBcIkAvbW9uYWQvb3B0aW9uYWxcIjtcbmltcG9ydCB7IEFzeW5jT3B0aW9uYWxSZXN1bHQsIE9wdGlvbmFsUmVzdWx0IH0gZnJvbSBcIkAvbW9uYWQvcmVzdWx0XCI7XG5pbXBvcnQgeyBpc0ZhaWx1cmUgfSBmcm9tIFwiQC9tb25hZC9tb25hZHMvZWl0aGVyL2ZhaWx1cmVcIjtcblxuY29uc3QgTm9uZVN5bWJvbCA9IFN5bWJvbChcIkpzTW9uYWROb25lU3ltYm9sXCIpO1xuXG5leHBvcnQgY2xhc3MgTm9uZSBpbXBsZW1lbnRzIE9wdGlvbmFsPG5ldmVyPiB7XG4gIFtOb25lU3ltYm9sXSA9IHRydWU7XG5cbiAgc3RhdGljIFtTeW1ib2wuaGFzSW5zdGFuY2VdKG9iajogYW55KTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIGlzTm9uZShvYmopO1xuICB9XG5cbiAgc3RhdGljIG9mKCk6IE5vbmUge1xuICAgIHJldHVybiBuZXcgTm9uZSgpO1xuICB9XG5cbiAgYmluZChmbjogKHZhbHVlOiBuZXZlcikgPT4gT3B0aW9uYWw8bmV2ZXI+KTogTm9uZSB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICB1bndyYXAoKTogbmV2ZXIge1xuICAgIHRocm93IG5ldyBFcnJvcihcIlZhbHVlIG9mIE5vbmUgY2Fubm90IGJlIHVud3JhcHBlZFwiKTtcbiAgfVxuXG4gIG1hcDxVPihmbjogKHZhbHVlOiBuZXZlcikgPT4gVSk6IE5vbmUge1xuICAgIHJldHVybiB0aGlzO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc05vbmU8VD4oXG4gIG9iajogT3B0aW9uYWxSZXN1bHQ8VD4gfCBBc3luY09wdGlvbmFsUmVzdWx0PFQ+LFxuKTogb2JqIGlzIE5vbmUge1xuICByZXR1cm4gb2JqICYmIChvYmogYXMgTm9uZSlbTm9uZVN5bWJvbF0gPT09IHRydWU7XG59XG4iLCJpbXBvcnQgeyBDb250ZXh0cyB9IGZyb20gXCJAL21vbmFkL2NvbnRleHQvY29udGV4dHNcIjtcbmltcG9ydCB7IENvbnRleHQgfSBmcm9tIFwiQC9tb25hZC9jb250ZXh0L2NvbnRleHRcIjtcbmltcG9ydCB7IE9wdGlvbmFsUmVzdWx0IH0gZnJvbSBcIkAvbW9uYWQvcmVzdWx0XCI7XG5pbXBvcnQgeyBTb21lIH0gZnJvbSBcIkAvbW9uYWQvbW9uYWRzL29wdGlvbmFsL3NvbWVcIjtcbmltcG9ydCB7IE5vbmUgfSBmcm9tIFwiQC9tb25hZC9tb25hZHMvb3B0aW9uYWwvbm9uZVwiO1xuXG5leHBvcnQgY2xhc3MgQ29udGV4dENvbGxlY3Rpb24gaW1wbGVtZW50cyBDb250ZXh0cyB7XG4gIHByaXZhdGUgY29udGV4dHM6IHsgW2tleTogc3RyaW5nXTogQ29udGV4dCB9ID0ge307XG5cbiAgc3RhdGljIGVtcHR5KCk6IENvbnRleHRDb2xsZWN0aW9uIHtcbiAgICByZXR1cm4gbmV3IENvbnRleHRDb2xsZWN0aW9uKCk7XG4gIH1cblxuICBnZXQoa2V5OiBzdHJpbmcpOiBPcHRpb25hbFJlc3VsdDxDb250ZXh0PiB7XG4gICAgcmV0dXJuIHRoaXMuY29udGV4dHNba2V5XSA/IFNvbWUub2YodGhpcy5jb250ZXh0c1trZXldKSA6IE5vbmUub2YoKTtcbiAgfVxuXG4gIGFkZChrZXk6IHN0cmluZywgY29udGV4dDogQ29udGV4dCk6IENvbnRleHRDb2xsZWN0aW9uIHtcbiAgICBjb25zdCBuZXdDb2xsZWN0aW9uID0gbmV3IENvbnRleHRDb2xsZWN0aW9uKCk7XG4gICAgbmV3Q29sbGVjdGlvbi5jb250ZXh0cyA9IHsgLi4udGhpcy5jb250ZXh0cyB9O1xuICAgIG5ld0NvbGxlY3Rpb24uY29udGV4dHNba2V5XSA9IGNvbnRleHQ7XG4gICAgcmV0dXJuIG5ld0NvbGxlY3Rpb247XG4gIH1cblxuICByZW1vdmUoa2V5OiBzdHJpbmcpOiBDb250ZXh0Q29sbGVjdGlvbiB7XG4gICAgY29uc3QgbmV3Q29sbGVjdGlvbiA9IG5ldyBDb250ZXh0Q29sbGVjdGlvbigpO1xuICAgIG5ld0NvbGxlY3Rpb24uY29udGV4dHMgPSB7IC4uLnRoaXMuY29udGV4dHMgfTtcbiAgICBkZWxldGUgbmV3Q29sbGVjdGlvbi5jb250ZXh0c1trZXldO1xuICAgIHJldHVybiBuZXdDb2xsZWN0aW9uO1xuICB9XG5cbiAgKltTeW1ib2wuaXRlcmF0b3JdKCk6IEl0ZXJhdG9yPENvbnRleHQ+IHtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiB0aGlzLmNvbnRleHRzKSB7XG4gICAgICB5aWVsZCB0aGlzLmNvbnRleHRzW2tleV07XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgeyBFaXRoZXIgfSBmcm9tIFwiQC9tb25hZC9laXRoZXJcIjtcbmltcG9ydCB7IEFzeW5jUmVzdWx0LCBPcHRpb25hbFJlc3VsdCwgUmVzdWx0IH0gZnJvbSBcIkAvbW9uYWQvcmVzdWx0XCI7XG5pbXBvcnQgeyBUcmFjZXMgfSBmcm9tIFwiQC9tb25hZC90cmFjZS90cmFjZXNcIjtcbmltcG9ydCB7IFRyYWNlIH0gZnJvbSBcIkAvbW9uYWQvdHJhY2UvdHJhY2VcIjtcbmltcG9ydCB7IENvbnRleHRzIH0gZnJvbSBcIkAvbW9uYWQvY29udGV4dC9jb250ZXh0c1wiO1xuaW1wb3J0IHsgQ29udGV4dCB9IGZyb20gXCJAL21vbmFkL2NvbnRleHQvY29udGV4dFwiO1xuaW1wb3J0IHsgVHJhY2VDb2xsZWN0aW9uIH0gZnJvbSBcIkAvbW9uYWQvdHJhY2UvdHJhY2UtY29sbGVjdGlvblwiO1xuaW1wb3J0IHsgVHJhY2VDb21tb24gfSBmcm9tIFwiQC9tb25hZC90cmFjZS90cmFjZS1jb21tb25cIjtcbmltcG9ydCB7IENvbnRleHRDb2xsZWN0aW9uIH0gZnJvbSBcIkAvbW9uYWQvY29udGV4dC9jb250ZXh0LWNvbGxlY3Rpb25cIjtcbmltcG9ydCB7IGlzU3VjY2VzcyB9IGZyb20gXCJAL21vbmFkL21vbmFkcy9laXRoZXIvc3VjY2Vzc1wiO1xuXG5jb25zdCBGYWlsdXJlU3ltYm9sID0gU3ltYm9sKFwiSnNNb25hZEZhaWx1cmVTeW1ib2xcIik7XG5cbmV4cG9ydCBjbGFzcyBGYWlsdXJlIGltcGxlbWVudHMgRWl0aGVyPG5ldmVyPiwgRXJyb3Ige1xuICBwcml2YXRlIHJlYWRvbmx5IHRyYWNlczogVHJhY2VzO1xuICBwcml2YXRlIHJlYWRvbmx5IGNvbnRleHRzOiBDb250ZXh0cztcbiAgbWVzc2FnZTogc3RyaW5nO1xuICBjb2RlOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbiAgcHJldmlvdXM6IEVycm9yIHwgbnVsbDtcblxuICBbRmFpbHVyZVN5bWJvbF0gPSB0cnVlO1xuXG4gIHN0YXRpYyBbU3ltYm9sLmhhc0luc3RhbmNlXShvYmo6IGFueSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBpc0ZhaWx1cmUob2JqKTtcbiAgfVxuXG4gIHByaXZhdGUgY29uc3RydWN0b3IoXG4gICAgbWVzc2FnZTogc3RyaW5nLFxuICAgIGNvZGU6IHN0cmluZyxcbiAgICB0cmFjZXM6IFRyYWNlcyxcbiAgICBjb250ZXh0czogQ29udGV4dHMsXG4gICAgcHJldmlvdXM6IEVycm9yIHwgbnVsbCxcbiAgKSB7XG4gICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcbiAgICB0aGlzLm5hbWUgPSBcIkZhaWx1cmVcIjtcbiAgICB0aGlzLmNvZGUgPSBjb2RlO1xuICAgIHRoaXMudHJhY2VzID0gdHJhY2VzO1xuICAgIHRoaXMuY29udGV4dHMgPSBjb250ZXh0cztcbiAgICB0aGlzLnByZXZpb3VzID0gcHJldmlvdXM7XG4gIH1cblxuICBzdGF0aWMgZHVlVG8oXG4gICAgbWVzc2FnZTogc3RyaW5nLFxuICAgIGNvZGU6IHN0cmluZyxcbiAgICBwcmV2aW91cz86IEVycm9yIHwgbnVsbCxcbiAgICB0cmFjZT86IFRyYWNlIHwgbnVsbCxcbiAgICB0cmFjZXM/OiBUcmFjZXMgfCBudWxsLFxuICAgIGNvbnRleHRzPzogQ29udGV4dHMgfCBudWxsLFxuICApOiBGYWlsdXJlIHtcbiAgICAvLyBBZGQgRmFpbHVyZSB0cmFjZXMgYXMgbGFzdCBpdGVtLlxuICAgIHRyYWNlcyA9IHRyYWNlcyA/PyBUcmFjZUNvbGxlY3Rpb24uZW1wdHkoKTtcbiAgICBpZiAodHJhY2UpIHtcbiAgICAgIHRyYWNlcy5hZGQodHJhY2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBGYWxsYmFjayB0byBhIGNvbW1vbiB0cmFjZSBvZiB0aGUgbWVzc2FnZSB3aGVuIG5vIHNwZWNpZmljIHRyYWNlIHdhcyBwcm92aWRlZC5cbiAgICAgIHRyYWNlcy5hZGQoVHJhY2VDb21tb24uZnJvbShtZXNzYWdlLCBEYXRlLm5vdygpKSk7XG4gICAgfVxuXG4gICAgY29udGV4dHMgPSBjb250ZXh0cyA/PyBDb250ZXh0Q29sbGVjdGlvbi5lbXB0eSgpO1xuICAgIHJldHVybiBuZXcgRmFpbHVyZShcbiAgICAgIG1lc3NhZ2UsXG4gICAgICBjb2RlLFxuICAgICAgdHJhY2VzLFxuICAgICAgY29udGV4dHMsXG4gICAgICBwcmV2aW91cyA/IHByZXZpb3VzIDogbnVsbCxcbiAgICApO1xuICB9XG5cbiAgYmluZChmbjogKHZhbHVlOiBuZXZlcikgPT4gUmVzdWx0PG5ldmVyPik6IFJlc3VsdDxuZXZlcj4ge1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgbWFwKGZuOiAodmFsdWU6IG5ldmVyKSA9PiBuZXZlcik6IFJlc3VsdDxuZXZlcj4ge1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgbGlmdCh2YWx1ZTogbmV2ZXIpOiBSZXN1bHQ8bmV2ZXI+IHtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHVud3JhcCgpOiBuZXZlciB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiVmFsdWUgb2YgRmFpbHVyZSBjYW4gbm90IGJlIHVud3JhcHBlZFwiKTtcbiAgfVxuXG4gIGdldFRyYWNlcygpOiBUcmFjZXMge1xuICAgIHJldHVybiB0aGlzLnRyYWNlcztcbiAgfVxuXG4gIHdpdGhUcmFjZSh0cmFjZTogVHJhY2UpOiBSZXN1bHQ8bmV2ZXI+IHtcbiAgICB0aGlzLnRyYWNlcy5hZGQodHJhY2UpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgd2l0aENvbnRleHQoa2V5OiBzdHJpbmcsIGNvbnRleHQ6IENvbnRleHQpOiBSZXN1bHQ8bmV2ZXI+IHtcbiAgICB0aGlzLmNvbnRleHRzLmFkZChrZXksIGNvbnRleHQpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgZ2V0Q29udGV4dChrZXk6IHN0cmluZyk6IE9wdGlvbmFsUmVzdWx0PENvbnRleHQ+IHtcbiAgICByZXR1cm4gdGhpcy5jb250ZXh0cy5nZXQoa2V5KTtcbiAgfVxuXG4gIGdldENvbnRleHRzKCk6IENvbnRleHRzIHtcbiAgICByZXR1cm4gdGhpcy5jb250ZXh0cztcbiAgfVxuXG4gIGNsZWFyQ29udGV4dChrZXk6IHN0cmluZyk6IFJlc3VsdDxuZXZlcj4ge1xuICAgIHRoaXMuY29udGV4dHMucmVtb3ZlKGtleSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRmFpbHVyZTxUPihvYmo6IEFzeW5jUmVzdWx0PFQ+IHwgUmVzdWx0PFQ+KTogb2JqIGlzIEZhaWx1cmUge1xuICByZXR1cm4gb2JqICYmIChvYmogYXMgRmFpbHVyZSlbRmFpbHVyZVN5bWJvbF0gPT09IHRydWU7XG59XG4iLCJpbXBvcnQgeyBFaXRoZXIgfSBmcm9tIFwiQC9tb25hZC9laXRoZXJcIjtcbmltcG9ydCB7IEFzeW5jUmVzdWx0LCBPcHRpb25hbFJlc3VsdCwgUmVzdWx0IH0gZnJvbSBcIkAvbW9uYWQvcmVzdWx0XCI7XG5pbXBvcnQgeyBDb250ZXh0cyB9IGZyb20gXCJAL21vbmFkL2NvbnRleHQvY29udGV4dHNcIjtcbmltcG9ydCB7IFRyYWNlcyB9IGZyb20gXCJAL21vbmFkL3RyYWNlL3RyYWNlc1wiO1xuaW1wb3J0IHsgVHJhY2UgfSBmcm9tIFwiQC9tb25hZC90cmFjZS90cmFjZVwiO1xuaW1wb3J0IHsgQ29udGV4dCB9IGZyb20gXCJAL21vbmFkL2NvbnRleHQvY29udGV4dFwiO1xuaW1wb3J0IHsgVHJhY2VDb2xsZWN0aW9uIH0gZnJvbSBcIkAvbW9uYWQvdHJhY2UvdHJhY2UtY29sbGVjdGlvblwiO1xuaW1wb3J0IHsgQ29udGV4dENvbGxlY3Rpb24gfSBmcm9tIFwiQC9tb25hZC9jb250ZXh0L2NvbnRleHQtY29sbGVjdGlvblwiO1xuaW1wb3J0IHsgRmFpbHVyZSB9IGZyb20gXCJAL21vbmFkL21vbmFkcy9laXRoZXIvZmFpbHVyZVwiO1xuXG5jb25zdCBTdWNjZXNzU3ltYm9sID0gU3ltYm9sKFwiSnNNb25hZFN1Y2Nlc3NTeW1ib2xcIik7XG5cbmV4cG9ydCBjbGFzcyBTdWNjZXNzPFQ+IGltcGxlbWVudHMgRWl0aGVyPFQ+IHtcbiAgcHJpdmF0ZSByZWFkb25seSB2YWx1ZTogVDtcbiAgcHJpdmF0ZSByZWFkb25seSB0cmFjZXM6IFRyYWNlcztcbiAgcHJpdmF0ZSByZWFkb25seSBjb250ZXh0czogQ29udGV4dHM7XG4gIFtTdWNjZXNzU3ltYm9sXSA9IHRydWU7XG5cbiAgc3RhdGljIFtTeW1ib2wuaGFzSW5zdGFuY2VdKG9iajogYW55KTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIGlzU3VjY2VzcyhvYmopO1xuICB9XG5cbiAgcHJpdmF0ZSBjb25zdHJ1Y3Rvcih2YWx1ZTogVCwgdHJhY2VzOiBUcmFjZXMsIGNvbnRleHRzOiBDb250ZXh0cykge1xuICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICB0aGlzLnRyYWNlcyA9IHRyYWNlcztcbiAgICB0aGlzLmNvbnRleHRzID0gY29udGV4dHM7XG4gIH1cblxuICBzdGF0aWMgb2YodmFsdWU6IGFueSwgdHJhY2VzPzogVHJhY2VzIHwgbnVsbCwgY29udGV4dHM/OiBDb250ZXh0cyB8IG51bGwpIHtcbiAgICByZXR1cm4gbmV3IFN1Y2Nlc3MoXG4gICAgICB2YWx1ZSxcbiAgICAgIHRyYWNlcyA/PyBUcmFjZUNvbGxlY3Rpb24uZW1wdHkoKSxcbiAgICAgIGNvbnRleHRzID8/IENvbnRleHRDb2xsZWN0aW9uLmVtcHR5KCksXG4gICAgKTtcbiAgfVxuXG4gIGJpbmQoZm46ICh2YWx1ZTogVCkgPT4gUmVzdWx0PFQ+KTogUmVzdWx0PFQ+IHtcbiAgICByZXR1cm4gZm4odGhpcy52YWx1ZSk7XG4gIH1cblxuICBsaWZ0KHZhbHVlOiBhbnkpOiBSZXN1bHQ8VD4ge1xuICAgIHJldHVybiBuZXcgU3VjY2Vzcyh2YWx1ZSwgdGhpcy50cmFjZXMsIHRoaXMuY29udGV4dHMpO1xuICB9XG5cbiAgbWFwKGZuOiAodmFsdWU6IGFueSkgPT4gYW55KTogUmVzdWx0PFQ+IHtcbiAgICByZXR1cm4gbmV3IFN1Y2Nlc3MoZm4odGhpcy52YWx1ZSksIHRoaXMudHJhY2VzLCB0aGlzLmNvbnRleHRzKTtcbiAgfVxuXG4gIHVud3JhcCgpOiBUIHtcbiAgICByZXR1cm4gdGhpcy52YWx1ZTtcbiAgfVxuXG4gIGdldFRyYWNlcygpOiBUcmFjZXMge1xuICAgIHJldHVybiB0aGlzLnRyYWNlcztcbiAgfVxuXG4gIHdpdGhUcmFjZSh0cmFjZTogVHJhY2UpOiBSZXN1bHQ8VD4ge1xuICAgIHRoaXMudHJhY2VzLmFkZCh0cmFjZSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICB3aXRoQ29udGV4dChrZXk6IHN0cmluZywgY29udGV4dDogQ29udGV4dCk6IFJlc3VsdDxUPiB7XG4gICAgdGhpcy5jb250ZXh0cy5hZGQoa2V5LCBjb250ZXh0KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGdldENvbnRleHQoa2V5OiBzdHJpbmcpOiBPcHRpb25hbFJlc3VsdDxDb250ZXh0PiB7XG4gICAgcmV0dXJuIHRoaXMuY29udGV4dHMuZ2V0KGtleSk7XG4gIH1cblxuICBnZXRDb250ZXh0cygpOiBDb250ZXh0cyB7XG4gICAgcmV0dXJuIHRoaXMuY29udGV4dHM7XG4gIH1cblxuICBjbGVhckNvbnRleHQoa2V5OiBzdHJpbmcpOiBSZXN1bHQ8VD4ge1xuICAgIHRoaXMuY29udGV4dHMucmVtb3ZlKGtleSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzU3VjY2VzczxUPihcbiAgb2JqOiBBc3luY1Jlc3VsdDxUPiB8IFJlc3VsdDxUPixcbik6IG9iaiBpcyBTdWNjZXNzPFQ+IHtcbiAgcmV0dXJuIG9iaiAmJiAob2JqIGFzIFN1Y2Nlc3M8VD4pW1N1Y2Nlc3NTeW1ib2xdID09PSB0cnVlO1xufVxuIiwiLy8gU3RlcCAxOiBDcmVhdGUgYSB1bmlxdWUgc3ltYm9sIHRvIHRhZyB0aGUgY2xhc3NcbmltcG9ydCB7IEFzeW5jUmVzdWx0LCBSZXN1bHQgfSBmcm9tIFwiQC9tb25hZC9yZXN1bHRcIjtcbmltcG9ydCB7IFN1Y2Nlc3MgfSBmcm9tIFwiQC9tb25hZC9tb25hZHMvZWl0aGVyL3N1Y2Nlc3NcIjtcblxuY29uc3QgQXdhaXRpbmdTeW1ib2wgPSBTeW1ib2woXCJKc01vbmFkQXdhaXRpbmdTeW1ib2xcIik7XG5cbi8vIFN0ZXAgMjogRGVmaW5lIHRoZSBBd2FpdGluZyBjbGFzcyBhbmQgdGFnIGl0IHdpdGggdGhlIHN5bWJvbFxuZXhwb3J0IGludGVyZmFjZSBBd2FpdGluZ0kge31cblxuZXhwb3J0IGNsYXNzIEF3YWl0aW5nIGltcGxlbWVudHMgQXdhaXRpbmdJIHtcbiAgLy8gVGFnZ2luZyB0aGUgY2xhc3Mgd2l0aCB0aGUgc3ltYm9sXG4gIFtBd2FpdGluZ1N5bWJvbF0gPSB0cnVlO1xufVxuXG4vLyBSZXR1cm5zICdUcnVlJyB3aGVuIG9uZSB2YWx1ZSBpcyBpbnN0YW5jZSBvZiBBd2FpdGluZy5cbmV4cG9ydCBmdW5jdGlvbiBpc0F3YWl0aW5nPFQ+KG9iajogQXN5bmNSZXN1bHQ8VD4pOiBvYmogaXMgQXdhaXRpbmcge1xuICByZXR1cm4gb2JqICYmIChvYmogYXMgQXdhaXRpbmcpW0F3YWl0aW5nU3ltYm9sXSA9PT0gdHJ1ZTtcbn1cbiIsImltcG9ydCB7IHVzZUVmZmVjdCwgdXNlUmVmIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBBc3luY1Jlc3VsdCB9IGZyb20gXCJAL21vbmFkL3Jlc3VsdFwiO1xuaW1wb3J0IHsgQXdhaXRpbmcgfSBmcm9tIFwiQC9tb25hZC9hd2FpdGluZ1wiO1xuaW1wb3J0IHsgU3VjY2VzcyB9IGZyb20gXCJAL21vbmFkL21vbmFkcy9laXRoZXIvc3VjY2Vzc1wiO1xuaW1wb3J0IHsgRmFpbHVyZSB9IGZyb20gXCJAL21vbmFkL21vbmFkcy9laXRoZXIvZmFpbHVyZVwiO1xuaW1wb3J0IGlzRXF1YWwgZnJvbSBcImZhc3QtZGVlcC1lcXVhbFwiO1xuXG50eXBlIENhbGxiYWNrczxUPiA9IHtcbiAgb25TdWNjZXNzPzogKHZhbHVlOiBUKSA9PiB2b2lkO1xuICBvbkZhaWx1cmU/OiAoZXJyb3I6IHN0cmluZykgPT4gdm9pZDtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VFZmZlY3RBc3luY1Jlc3VsdDxUPihcbiAgcmVzdWx0OiBBc3luY1Jlc3VsdDxUPixcbiAgeyBvblN1Y2Nlc3MsIG9uRmFpbHVyZSB9OiBDYWxsYmFja3M8VD4sXG4pOiB2b2lkIHtcbiAgY29uc3QgcHJldmlvdXNSZWYgPSB1c2VSZWY8QXN5bmNSZXN1bHQ8VD4+KG5ldyBBd2FpdGluZygpKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IHByZXZpb3VzID0gcHJldmlvdXNSZWYuY3VycmVudDtcblxuICAgIGNvbnN0IGhhc1N0YXR1c0NoYW5nZWQgPSAoKCkgPT4ge1xuICAgICAgaWYgKFxuICAgICAgICBwcmV2aW91cyBpbnN0YW5jZW9mIEF3YWl0aW5nICYmXG4gICAgICAgIChyZXN1bHQgaW5zdGFuY2VvZiBTdWNjZXNzIHx8IHJlc3VsdCBpbnN0YW5jZW9mIEZhaWx1cmUpXG4gICAgICApIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICBpZiAocHJldmlvdXMgaW5zdGFuY2VvZiBTdWNjZXNzICYmIHJlc3VsdCBpbnN0YW5jZW9mIEZhaWx1cmUpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICBpZiAocHJldmlvdXMgaW5zdGFuY2VvZiBGYWlsdXJlICYmIHJlc3VsdCBpbnN0YW5jZW9mIFN1Y2Nlc3MpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSkoKTtcblxuICAgIGNvbnN0IGhhc1ZhbHVlQ2hhbmdlZCA9XG4gICAgICByZXN1bHQgaW5zdGFuY2VvZiBTdWNjZXNzICYmXG4gICAgICBwcmV2aW91cyBpbnN0YW5jZW9mIFN1Y2Nlc3MgJiZcbiAgICAgICFpc0VxdWFsKHByZXZpb3VzLnVud3JhcCgpLCByZXN1bHQudW53cmFwKCkpO1xuXG4gICAgaWYgKGhhc1N0YXR1c0NoYW5nZWQgfHwgaGFzVmFsdWVDaGFuZ2VkKSB7XG4gICAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgU3VjY2VzcyAmJiBvblN1Y2Nlc3MpIHtcbiAgICAgICAgb25TdWNjZXNzKHJlc3VsdC51bndyYXAoKSk7XG4gICAgICB9XG4gICAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgRmFpbHVyZSAmJiBvbkZhaWx1cmUpIHtcbiAgICAgICAgb25GYWlsdXJlKHJlc3VsdC51bndyYXAoKSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcHJldmlvdXNSZWYuY3VycmVudCA9IHJlc3VsdDtcbiAgfSwgW3Jlc3VsdCwgb25TdWNjZXNzLCBvbkZhaWx1cmVdKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgdXNlRWZmZWN0QXN5bmNSZXN1bHQ7XG4iXX0=