var s=class e{constructor(){this.traces=[];}static empty(){return new e}add(t){let r=new e;return r.traces=[...this.traces,t],r}*[Symbol.iterator](){for(let t of this.traces)yield t;}};var a=class e{constructor(t,r){this.message=t,this.time=r;}static from(t,r){return new e(t,r)}read(){return this.message}at(){return this.time}};var w=Symbol("JsMonadSomeSymbol"),g;g=w;var p=class p{constructor(t){this[g]=!0;this.value=t;}static of(t){return new p(t)}bind(t){return t(this.value)}unwrap(){return this.value}map(t){let r=t(this.value);return p.of(r)}},l=p;function N(e){return e&&e[w]===!0}var A=Symbol("JsMonadNoneSymbol"),S;S=A;var y=class y{constructor(){this[S]=!0;}static of(){return new y}bind(t){return this}unwrap(){throw new Error("Value of None cannot be unwrapped")}map(t){return this}},u=y;function E(e){return e&&e[A]===!0}var i=class e{constructor(){this.contexts={};}static empty(){return new e}get(t){return this.contexts[t]?l.of(this.contexts[t]):u.of()}add(t,r){let n=new e;return n.contexts={...this.contexts},n.contexts[t]=r,n}remove(t){let r=new e;return r.contexts={...this.contexts},delete r.contexts[t],r}*[Symbol.iterator](){for(let t in this.contexts)yield this.contexts[t];}};var x=Symbol("JsMonadFailureSymbol"),b;b=x;var v=class v{constructor(t,r,n,m,o){this[b]=!0;this.message=t,this.name="Failure",this.code=r,this.traces=n,this.contexts=m,this.previous=o;}static dueTo(t,r,n,m,o,T){return o=o??s.empty(),m?o.add(m):o.add(a.from(t,Date.now())),T=T??i.empty(),new v(t,r,o,T,n||null)}bind(t){return this}map(t){return this}lift(t){return this}unwrap(){throw new Error("Value of Failure can not be unwrapped")}getTraces(){return this.traces}withTrace(t){return this.traces.add(t),this}withContext(t,r){return this.contexts.add(t,r),this}getContext(t){return this.contexts.get(t)}getContexts(){return this.contexts}clearContext(t){return this.contexts.remove(t),this}},h=v;function U(e){return e&&e[x]===!0}function J(e){return Array.isArray(e)?e.some(t=>t&&t[x]===!0):e&&e[x]===!0}var f=Symbol("JsMonadSuccessSymbol"),O;O=f;var c=class c{constructor(t,r,n){this[O]=!0;this.value=t,this.traces=r,this.contexts=n;}static of(t,r,n){return new c(t,r??s.empty(),n??i.empty())}bind(t){return t(this.value)}lift(t){return new c(t,this.traces,this.contexts)}map(t){return new c(t(this.value),this.traces,this.contexts)}unwrap(){return this.value}getTraces(){return this.traces}withTrace(t){return this.traces.add(t),this}withContext(t,r){return this.contexts.add(t,r),this}getContext(t){return this.contexts.get(t)}getContexts(){return this.contexts}clearContext(t){return this.contexts.remove(t),this}},C=c;function M(e){return e&&e[f]===!0}function I(e){return Array.isArray(e)?e.every(t=>t&&t[f]===!0):e&&e[f]===!0}var d=Symbol("JsMonadAwaitingSymbol"),F;F=d;var R=class{constructor(){this[F]=!0;}};function V(e){return Array.isArray(e)?e.some(t=>t&&t[d]===!0):e&&e[d]===!0}

export { R as Awaiting, i as ContextCollection, h as Failure, u as None, l as Some, C as Success, s as TraceCollection, a as TraceCommon, I as allSuccessful, J as hasFailure, V as isAwaiting, U as isFailure, E as isNone, N as isSome, M as isSuccess };
//# sourceMappingURL=out.js.map
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9tb25hZC90cmFjZS90cmFjZS1jb2xsZWN0aW9uLnRzIiwiLi4vc3JjL21vbmFkL3RyYWNlL3RyYWNlLWNvbW1vbi50cyIsIi4uL3NyYy9tb25hZC9tb25hZHMvb3B0aW9uYWwvc29tZS50cyIsIi4uL3NyYy9tb25hZC9tb25hZHMvb3B0aW9uYWwvbm9uZS50cyIsIi4uL3NyYy9tb25hZC9jb250ZXh0L2NvbnRleHQtY29sbGVjdGlvbi50cyIsIi4uL3NyYy9tb25hZC9tb25hZHMvZWl0aGVyL2ZhaWx1cmUudHMiLCIuLi9zcmMvbW9uYWQvbW9uYWRzL2VpdGhlci9zdWNjZXNzLnRzIiwiLi4vc3JjL21vbmFkL2F3YWl0aW5nLnRzIl0sIm5hbWVzIjpbIlRyYWNlQ29sbGVjdGlvbiIsIl9UcmFjZUNvbGxlY3Rpb24iLCJ0cmFjZSIsIm5ld0NvbGxlY3Rpb24iLCJUcmFjZUNvbW1vbiIsIl9UcmFjZUNvbW1vbiIsIm1lc3NhZ2UiLCJ0aW1lIiwiU29tZVN5bWJvbCIsIl9hIiwiX1NvbWUiLCJ2YWx1ZSIsImZuIiwibmV3VmFsdWUiLCJTb21lIiwiaXNTb21lIiwib2JqIiwiTm9uZVN5bWJvbCIsIl9Ob25lIiwiTm9uZSIsImlzTm9uZSIsIkNvbnRleHRDb2xsZWN0aW9uIiwiX0NvbnRleHRDb2xsZWN0aW9uIiwia2V5IiwiY29udGV4dCIsIkZhaWx1cmVTeW1ib2wiLCJfRmFpbHVyZSIsImNvZGUiLCJ0cmFjZXMiLCJjb250ZXh0cyIsInByZXZpb3VzIiwiRmFpbHVyZSIsImlzRmFpbHVyZSIsImhhc0ZhaWx1cmUiLCJpdGVtIiwiU3VjY2Vzc1N5bWJvbCIsIl9TdWNjZXNzIiwiU3VjY2VzcyIsImlzU3VjY2VzcyIsImFsbFN1Y2Nlc3NmdWwiLCJBd2FpdGluZ1N5bWJvbCIsIkF3YWl0aW5nIiwiaXNBd2FpdGluZyJdLCJtYXBwaW5ncyI6IkFBSU8sSUFBTUEsRUFBTixNQUFNQyxDQUFrQyxDQUdyQyxhQUFjLENBRnRCLEtBQVUsT0FBa0IsQ0FB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LFNBQVMsSUFBSUQsRUFBS0MsQ0FBTyxFQUN2QixJQUNULENBRUEsV0FBV0QsRUFBc0MsQ0FDL0MsT0FBTyxLQUFLLFNBQVMsSUFBSUEsQ0FBRyxDQUM5QixDQUVBLGFBQXdCLENBQ3RCLE9BQU8sS0FBSyxRQUNkLENBRUEsYUFBYUEsRUFBd0IsQ0FDbkMsWUFBSyxTQUFTLE9BQU9BLENBQUcsRUFDakIsSUFDVCxDQUNGLEVBOURhYyxFQUFORCxFQWdFQSxTQUFTRSxFQUNkdEIsRUFDbUIsQ0FDbkIsT0FBT0EsR0FBUUEsRUFBbUJtQixDQUFhLElBQU0sRUFDdkQsQ0FFTyxTQUFTSSxFQUNkdkIsRUFDa0MsQ0FDbEMsT0FBSSxNQUFNLFFBQVFBLENBQUcsRUFDWkEsRUFBSSxNQUNSa0IsR0FBU0EsR0FBU0EsRUFBb0JDLENBQWEsSUFBTSxFQUM1RCxFQUVLbkIsR0FBUUEsRUFBbUJtQixDQUFhLElBQU0sRUFDdkQsQ0N4RkEsSUFBTUssRUFBaUIsT0FBTyx1QkFBdUIsRUFIckQvQixFQVVHQSxFQUFBK0IsRUFGSSxJQUFNQyxFQUFOLEtBQW9DLENBQXBDLGNBRUwsS0FBQ2hDLEdBQWtCLEdBQ3JCLEVBR08sU0FBU2lDLEVBQ2QxQixFQUM4QixDQUM5QixPQUFJLE1BQU0sUUFBUUEsQ0FBRyxFQUNaQSxFQUFJLEtBQ1JrQixHQUFTQSxHQUFTQSxFQUFrQk0sQ0FBYyxJQUFNLEVBQzNELEVBRUt4QixHQUFRQSxFQUFpQndCLENBQWMsSUFBTSxFQUN0RCIsInNvdXJjZXNDb250ZW50IjpbIi8vIEltcGxlbWVudCB0aGUgVHJhY2VDb2xsZWN0aW9uIGNsYXNzXG5pbXBvcnQgeyBUcmFjZXMgfSBmcm9tIFwiQC9tb25hZC90cmFjZS90cmFjZXNcIjtcbmltcG9ydCB7IFRyYWNlIH0gZnJvbSBcIkAvbW9uYWQvdHJhY2UvdHJhY2VcIjtcblxuZXhwb3J0IGNsYXNzIFRyYWNlQ29sbGVjdGlvbiBpbXBsZW1lbnRzIFRyYWNlcyB7XG4gIHByb3RlY3RlZCB0cmFjZXM6IFRyYWNlW10gPSBbXTtcblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge31cblxuICBwdWJsaWMgc3RhdGljIGVtcHR5KCk6IFRyYWNlQ29sbGVjdGlvbiB7XG4gICAgcmV0dXJuIG5ldyBUcmFjZUNvbGxlY3Rpb24oKTtcbiAgfVxuXG4gIHB1YmxpYyBhZGQodHJhY2U6IFRyYWNlKTogVHJhY2VDb2xsZWN0aW9uIHtcbiAgICBjb25zdCBuZXdDb2xsZWN0aW9uID0gbmV3IFRyYWNlQ29sbGVjdGlvbigpO1xuICAgIG5ld0NvbGxlY3Rpb24udHJhY2VzID0gWy4uLnRoaXMudHJhY2VzLCB0cmFjZV07XG4gICAgcmV0dXJuIG5ld0NvbGxlY3Rpb247XG4gIH1cblxuICBwdWJsaWMgKltTeW1ib2wuaXRlcmF0b3JdKCk6IEl0ZXJhdG9yPFRyYWNlPiB7XG4gICAgZm9yIChjb25zdCB0cmFjZSBvZiB0aGlzLnRyYWNlcykge1xuICAgICAgeWllbGQgdHJhY2U7XG4gICAgfVxuICB9XG59XG4iLCIvLyBJbXBsZW1lbnQgdGhlIFRyYWNlQ29tbW9uIGNsYXNzXG5pbXBvcnQgeyBUcmFjZSB9IGZyb20gXCJAL21vbmFkL3RyYWNlL3RyYWNlXCI7XG5cbmV4cG9ydCBjbGFzcyBUcmFjZUNvbW1vbiBpbXBsZW1lbnRzIFRyYWNlIHtcbiAgcHJpdmF0ZSByZWFkb25seSBtZXNzYWdlOiBzdHJpbmc7XG4gIHByaXZhdGUgcmVhZG9ubHkgdGltZTogbnVtYmVyO1xuXG4gIHByaXZhdGUgY29uc3RydWN0b3IobWVzc2FnZTogc3RyaW5nLCB0aW1lOiBudW1iZXIpIHtcbiAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgIHRoaXMudGltZSA9IHRpbWU7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGZyb20obWVzc2FnZTogc3RyaW5nLCB0aW1lOiBudW1iZXIpOiBUcmFjZUNvbW1vbiB7XG4gICAgcmV0dXJuIG5ldyBUcmFjZUNvbW1vbihtZXNzYWdlLCB0aW1lKTtcbiAgfVxuXG4gIHB1YmxpYyByZWFkKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMubWVzc2FnZTtcbiAgfVxuXG4gIHB1YmxpYyBhdCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLnRpbWU7XG4gIH1cbn1cbiIsImltcG9ydCB7IE9wdGlvbmFsIH0gZnJvbSBcIkAvbW9uYWQvb3B0aW9uYWxcIjtcbmltcG9ydCB7IEFzeW5jT3B0aW9uYWxSZXN1bHQsIE9wdGlvbmFsUmVzdWx0IH0gZnJvbSBcIkAvbW9uYWQvcmVzdWx0XCI7XG5pbXBvcnQgeyBOb25lIH0gZnJvbSBcIkAvbW9uYWQvbW9uYWRzL29wdGlvbmFsL25vbmVcIjtcblxuY29uc3QgU29tZVN5bWJvbCA9IFN5bWJvbChcIkpzTW9uYWRTb21lU3ltYm9sXCIpO1xuXG5leHBvcnQgY2xhc3MgU29tZTxUPiBpbXBsZW1lbnRzIE9wdGlvbmFsPFQ+IHtcbiAgcHJpdmF0ZSByZWFkb25seSB2YWx1ZTogVDtcblxuICBbU29tZVN5bWJvbF0gPSB0cnVlO1xuXG4gIHByaXZhdGUgY29uc3RydWN0b3IodmFsdWU6IFQpIHtcbiAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gIH1cblxuICBzdGF0aWMgb2Y8VD4odmFsdWU6IFQpOiBTb21lPFQ+IHtcbiAgICByZXR1cm4gbmV3IFNvbWUodmFsdWUpO1xuICB9XG5cbiAgYmluZDxVPihmbjogKHZhbHVlOiBUKSA9PiBPcHRpb25hbDxVPik6IE9wdGlvbmFsPFU+IHtcbiAgICByZXR1cm4gZm4odGhpcy52YWx1ZSk7XG4gIH1cblxuICB1bndyYXAoKTogVCB7XG4gICAgcmV0dXJuIHRoaXMudmFsdWU7XG4gIH1cblxuICBtYXA8VT4oZm46ICh2YWx1ZTogVCkgPT4gVSk6IE9wdGlvbmFsPFU+IHtcbiAgICBjb25zdCBuZXdWYWx1ZSA9IGZuKHRoaXMudmFsdWUpO1xuICAgIHJldHVybiBTb21lLm9mKG5ld1ZhbHVlKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNTb21lPFQ+KFxuICBvYmo6IE9wdGlvbmFsUmVzdWx0PGFueT4gfCBBc3luY09wdGlvbmFsUmVzdWx0PGFueT4sXG4pOiBvYmogaXMgU29tZTxUPiB7XG4gIHJldHVybiBvYmogJiYgKG9iaiBhcyBTb21lPFQ+KVtTb21lU3ltYm9sXSA9PT0gdHJ1ZTtcbn1cbiIsIi8vIERlZmluZSB0aGUgTm9uZSBjbGFzcyBpbXBsZW1lbnRpbmcgdGhlIE9wdGlvbmFsIGludGVyZmFjZVxuaW1wb3J0IHsgT3B0aW9uYWwgfSBmcm9tIFwiQC9tb25hZC9vcHRpb25hbFwiO1xuaW1wb3J0IHsgQXN5bmNPcHRpb25hbFJlc3VsdCwgT3B0aW9uYWxSZXN1bHQgfSBmcm9tIFwiQC9tb25hZC9yZXN1bHRcIjtcblxuY29uc3QgTm9uZVN5bWJvbCA9IFN5bWJvbChcIkpzTW9uYWROb25lU3ltYm9sXCIpO1xuXG5leHBvcnQgY2xhc3MgTm9uZSBpbXBsZW1lbnRzIE9wdGlvbmFsPG5ldmVyPiB7XG4gIFtOb25lU3ltYm9sXSA9IHRydWU7XG5cbiAgc3RhdGljIG9mKCk6IE5vbmUge1xuICAgIHJldHVybiBuZXcgTm9uZSgpO1xuICB9XG5cbiAgYmluZChmbjogKHZhbHVlOiBuZXZlcikgPT4gT3B0aW9uYWw8bmV2ZXI+KTogTm9uZSB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICB1bndyYXAoKTogbmV2ZXIge1xuICAgIHRocm93IG5ldyBFcnJvcihcIlZhbHVlIG9mIE5vbmUgY2Fubm90IGJlIHVud3JhcHBlZFwiKTtcbiAgfVxuXG4gIG1hcDxVPihmbjogKHZhbHVlOiBuZXZlcikgPT4gVSk6IE5vbmUge1xuICAgIHJldHVybiB0aGlzO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc05vbmU8VD4oXG4gIG9iajogT3B0aW9uYWxSZXN1bHQ8VD4gfCBBc3luY09wdGlvbmFsUmVzdWx0PFQ+LFxuKTogb2JqIGlzIE5vbmUge1xuICByZXR1cm4gb2JqICYmIChvYmogYXMgTm9uZSlbTm9uZVN5bWJvbF0gPT09IHRydWU7XG59XG4iLCJpbXBvcnQgeyBDb250ZXh0cyB9IGZyb20gXCJAL21vbmFkL2NvbnRleHQvY29udGV4dHNcIjtcbmltcG9ydCB7IENvbnRleHQgfSBmcm9tIFwiQC9tb25hZC9jb250ZXh0L2NvbnRleHRcIjtcbmltcG9ydCB7IE9wdGlvbmFsUmVzdWx0IH0gZnJvbSBcIkAvbW9uYWQvcmVzdWx0XCI7XG5pbXBvcnQgeyBTb21lIH0gZnJvbSBcIkAvbW9uYWQvbW9uYWRzL29wdGlvbmFsL3NvbWVcIjtcbmltcG9ydCB7IE5vbmUgfSBmcm9tIFwiQC9tb25hZC9tb25hZHMvb3B0aW9uYWwvbm9uZVwiO1xuXG5leHBvcnQgY2xhc3MgQ29udGV4dENvbGxlY3Rpb24gaW1wbGVtZW50cyBDb250ZXh0cyB7XG4gIHByaXZhdGUgY29udGV4dHM6IHsgW2tleTogc3RyaW5nXTogQ29udGV4dCB9ID0ge307XG5cbiAgc3RhdGljIGVtcHR5KCk6IENvbnRleHRDb2xsZWN0aW9uIHtcbiAgICByZXR1cm4gbmV3IENvbnRleHRDb2xsZWN0aW9uKCk7XG4gIH1cblxuICBnZXQoa2V5OiBzdHJpbmcpOiBPcHRpb25hbFJlc3VsdDxDb250ZXh0PiB7XG4gICAgcmV0dXJuIHRoaXMuY29udGV4dHNba2V5XSA/IFNvbWUub2YodGhpcy5jb250ZXh0c1trZXldKSA6IE5vbmUub2YoKTtcbiAgfVxuXG4gIGFkZChrZXk6IHN0cmluZywgY29udGV4dDogQ29udGV4dCk6IENvbnRleHRDb2xsZWN0aW9uIHtcbiAgICBjb25zdCBuZXdDb2xsZWN0aW9uID0gbmV3IENvbnRleHRDb2xsZWN0aW9uKCk7XG4gICAgbmV3Q29sbGVjdGlvbi5jb250ZXh0cyA9IHsgLi4udGhpcy5jb250ZXh0cyB9O1xuICAgIG5ld0NvbGxlY3Rpb24uY29udGV4dHNba2V5XSA9IGNvbnRleHQ7XG4gICAgcmV0dXJuIG5ld0NvbGxlY3Rpb247XG4gIH1cblxuICByZW1vdmUoa2V5OiBzdHJpbmcpOiBDb250ZXh0Q29sbGVjdGlvbiB7XG4gICAgY29uc3QgbmV3Q29sbGVjdGlvbiA9IG5ldyBDb250ZXh0Q29sbGVjdGlvbigpO1xuICAgIG5ld0NvbGxlY3Rpb24uY29udGV4dHMgPSB7IC4uLnRoaXMuY29udGV4dHMgfTtcbiAgICBkZWxldGUgbmV3Q29sbGVjdGlvbi5jb250ZXh0c1trZXldO1xuICAgIHJldHVybiBuZXdDb2xsZWN0aW9uO1xuICB9XG5cbiAgKltTeW1ib2wuaXRlcmF0b3JdKCk6IEl0ZXJhdG9yPENvbnRleHQ+IHtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiB0aGlzLmNvbnRleHRzKSB7XG4gICAgICB5aWVsZCB0aGlzLmNvbnRleHRzW2tleV07XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgeyBFaXRoZXIgfSBmcm9tIFwiQC9tb25hZC9laXRoZXJcIjtcbmltcG9ydCB7IEFzeW5jUmVzdWx0LCBPcHRpb25hbFJlc3VsdCwgUmVzdWx0IH0gZnJvbSBcIkAvbW9uYWQvcmVzdWx0XCI7XG5pbXBvcnQgeyBUcmFjZXMgfSBmcm9tIFwiQC9tb25hZC90cmFjZS90cmFjZXNcIjtcbmltcG9ydCB7IFRyYWNlIH0gZnJvbSBcIkAvbW9uYWQvdHJhY2UvdHJhY2VcIjtcbmltcG9ydCB7IENvbnRleHRzIH0gZnJvbSBcIkAvbW9uYWQvY29udGV4dC9jb250ZXh0c1wiO1xuaW1wb3J0IHsgQ29udGV4dCB9IGZyb20gXCJAL21vbmFkL2NvbnRleHQvY29udGV4dFwiO1xuaW1wb3J0IHsgVHJhY2VDb2xsZWN0aW9uIH0gZnJvbSBcIkAvbW9uYWQvdHJhY2UvdHJhY2UtY29sbGVjdGlvblwiO1xuaW1wb3J0IHsgVHJhY2VDb21tb24gfSBmcm9tIFwiQC9tb25hZC90cmFjZS90cmFjZS1jb21tb25cIjtcbmltcG9ydCB7IENvbnRleHRDb2xsZWN0aW9uIH0gZnJvbSBcIkAvbW9uYWQvY29udGV4dC9jb250ZXh0LWNvbGxlY3Rpb25cIjtcblxuY29uc3QgRmFpbHVyZVN5bWJvbCA9IFN5bWJvbChcIkpzTW9uYWRGYWlsdXJlU3ltYm9sXCIpO1xuXG5leHBvcnQgY2xhc3MgRmFpbHVyZSBpbXBsZW1lbnRzIEVpdGhlcjxuZXZlcj4sIEVycm9yIHtcbiAgcHJpdmF0ZSByZWFkb25seSB0cmFjZXM6IFRyYWNlcztcbiAgcHJpdmF0ZSByZWFkb25seSBjb250ZXh0czogQ29udGV4dHM7XG4gIG1lc3NhZ2U6IHN0cmluZztcbiAgY29kZTogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIHByZXZpb3VzOiBFcnJvciB8IG51bGw7XG5cbiAgW0ZhaWx1cmVTeW1ib2xdID0gdHJ1ZTtcblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKFxuICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICBjb2RlOiBzdHJpbmcsXG4gICAgdHJhY2VzOiBUcmFjZXMsXG4gICAgY29udGV4dHM6IENvbnRleHRzLFxuICAgIHByZXZpb3VzOiBFcnJvciB8IG51bGwsXG4gICkge1xuICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgdGhpcy5uYW1lID0gXCJGYWlsdXJlXCI7XG4gICAgdGhpcy5jb2RlID0gY29kZTtcbiAgICB0aGlzLnRyYWNlcyA9IHRyYWNlcztcbiAgICB0aGlzLmNvbnRleHRzID0gY29udGV4dHM7XG4gICAgdGhpcy5wcmV2aW91cyA9IHByZXZpb3VzO1xuICB9XG5cbiAgc3RhdGljIGR1ZVRvKFxuICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICBjb2RlOiBzdHJpbmcsXG4gICAgcHJldmlvdXM/OiBFcnJvciB8IG51bGwsXG4gICAgdHJhY2U/OiBUcmFjZSB8IG51bGwsXG4gICAgdHJhY2VzPzogVHJhY2VzIHwgbnVsbCxcbiAgICBjb250ZXh0cz86IENvbnRleHRzIHwgbnVsbCxcbiAgKTogRmFpbHVyZSB7XG4gICAgLy8gQWRkIEZhaWx1cmUgdHJhY2VzIGFzIGxhc3QgaXRlbS5cbiAgICB0cmFjZXMgPSB0cmFjZXMgPz8gVHJhY2VDb2xsZWN0aW9uLmVtcHR5KCk7XG4gICAgaWYgKHRyYWNlKSB7XG4gICAgICB0cmFjZXMuYWRkKHRyYWNlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gRmFsbGJhY2sgdG8gYSBjb21tb24gdHJhY2Ugb2YgdGhlIG1lc3NhZ2Ugd2hlbiBubyBzcGVjaWZpYyB0cmFjZSB3YXMgcHJvdmlkZWQuXG4gICAgICB0cmFjZXMuYWRkKFRyYWNlQ29tbW9uLmZyb20obWVzc2FnZSwgRGF0ZS5ub3coKSkpO1xuICAgIH1cblxuICAgIGNvbnRleHRzID0gY29udGV4dHMgPz8gQ29udGV4dENvbGxlY3Rpb24uZW1wdHkoKTtcbiAgICByZXR1cm4gbmV3IEZhaWx1cmUoXG4gICAgICBtZXNzYWdlLFxuICAgICAgY29kZSxcbiAgICAgIHRyYWNlcyxcbiAgICAgIGNvbnRleHRzLFxuICAgICAgcHJldmlvdXMgPyBwcmV2aW91cyA6IG51bGwsXG4gICAgKTtcbiAgfVxuXG4gIGJpbmQoZm46ICh2YWx1ZTogbmV2ZXIpID0+IFJlc3VsdDxuZXZlcj4pOiBSZXN1bHQ8bmV2ZXI+IHtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIG1hcChmbjogKHZhbHVlOiBuZXZlcikgPT4gbmV2ZXIpOiBSZXN1bHQ8bmV2ZXI+IHtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGxpZnQodmFsdWU6IG5ldmVyKTogUmVzdWx0PG5ldmVyPiB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICB1bndyYXAoKTogbmV2ZXIge1xuICAgIHRocm93IG5ldyBFcnJvcihcIlZhbHVlIG9mIEZhaWx1cmUgY2FuIG5vdCBiZSB1bndyYXBwZWRcIik7XG4gIH1cblxuICBnZXRUcmFjZXMoKTogVHJhY2VzIHtcbiAgICByZXR1cm4gdGhpcy50cmFjZXM7XG4gIH1cblxuICB3aXRoVHJhY2UodHJhY2U6IFRyYWNlKTogUmVzdWx0PG5ldmVyPiB7XG4gICAgdGhpcy50cmFjZXMuYWRkKHRyYWNlKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHdpdGhDb250ZXh0KGtleTogc3RyaW5nLCBjb250ZXh0OiBDb250ZXh0KTogUmVzdWx0PG5ldmVyPiB7XG4gICAgdGhpcy5jb250ZXh0cy5hZGQoa2V5LCBjb250ZXh0KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGdldENvbnRleHQoa2V5OiBzdHJpbmcpOiBPcHRpb25hbFJlc3VsdDxDb250ZXh0PiB7XG4gICAgcmV0dXJuIHRoaXMuY29udGV4dHMuZ2V0KGtleSk7XG4gIH1cblxuICBnZXRDb250ZXh0cygpOiBDb250ZXh0cyB7XG4gICAgcmV0dXJuIHRoaXMuY29udGV4dHM7XG4gIH1cblxuICBjbGVhckNvbnRleHQoa2V5OiBzdHJpbmcpOiBSZXN1bHQ8bmV2ZXI+IHtcbiAgICB0aGlzLmNvbnRleHRzLnJlbW92ZShrZXkpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0ZhaWx1cmU8VD4ob2JqOiBBc3luY1Jlc3VsdDxUPiB8IFJlc3VsdDxUPik6IG9iaiBpcyBGYWlsdXJlIHtcbiAgcmV0dXJuIG9iaiAmJiAob2JqIGFzIEZhaWx1cmUpW0ZhaWx1cmVTeW1ib2xdID09PSB0cnVlO1xufVxuXG4vLyBSZXR1cm5zICdUcnVlJyB3aGVuIG9uZSB2YWx1ZSBpcyBpbnN0YW5jZSBvZiBGYWlsdXJlLlxuZXhwb3J0IGZ1bmN0aW9uIGhhc0ZhaWx1cmUoXG4gIG9iajogQXN5bmNSZXN1bHQ8YW55PiB8IEFzeW5jUmVzdWx0PGFueT5bXSxcbik6IG9iaiBpcyBGYWlsdXJlIHwgRmFpbHVyZVtdIHtcbiAgaWYgKEFycmF5LmlzQXJyYXkob2JqKSkge1xuICAgIHJldHVybiBvYmouc29tZShcbiAgICAgIChpdGVtKSA9PiBpdGVtICYmIChpdGVtIGFzIEZhaWx1cmUpW0ZhaWx1cmVTeW1ib2xdID09PSB0cnVlLFxuICAgICk7XG4gIH1cbiAgcmV0dXJuIG9iaiAmJiAob2JqIGFzIEZhaWx1cmUpW0ZhaWx1cmVTeW1ib2xdID09PSB0cnVlO1xufVxuIiwiaW1wb3J0IHsgRWl0aGVyIH0gZnJvbSBcIkAvbW9uYWQvZWl0aGVyXCI7XG5pbXBvcnQgeyBBc3luY1Jlc3VsdCwgT3B0aW9uYWxSZXN1bHQsIFJlc3VsdCB9IGZyb20gXCJAL21vbmFkL3Jlc3VsdFwiO1xuaW1wb3J0IHsgQ29udGV4dHMgfSBmcm9tIFwiQC9tb25hZC9jb250ZXh0L2NvbnRleHRzXCI7XG5pbXBvcnQgeyBUcmFjZXMgfSBmcm9tIFwiQC9tb25hZC90cmFjZS90cmFjZXNcIjtcbmltcG9ydCB7IFRyYWNlIH0gZnJvbSBcIkAvbW9uYWQvdHJhY2UvdHJhY2VcIjtcbmltcG9ydCB7IENvbnRleHQgfSBmcm9tIFwiQC9tb25hZC9jb250ZXh0L2NvbnRleHRcIjtcbmltcG9ydCB7IFRyYWNlQ29sbGVjdGlvbiB9IGZyb20gXCJAL21vbmFkL3RyYWNlL3RyYWNlLWNvbGxlY3Rpb25cIjtcbmltcG9ydCB7IENvbnRleHRDb2xsZWN0aW9uIH0gZnJvbSBcIkAvbW9uYWQvY29udGV4dC9jb250ZXh0LWNvbGxlY3Rpb25cIjtcbmltcG9ydCB7IEZhaWx1cmUgfSBmcm9tIFwiQC9tb25hZC9tb25hZHMvZWl0aGVyL2ZhaWx1cmVcIjtcblxuY29uc3QgU3VjY2Vzc1N5bWJvbCA9IFN5bWJvbChcIkpzTW9uYWRTdWNjZXNzU3ltYm9sXCIpO1xuXG5leHBvcnQgY2xhc3MgU3VjY2VzczxUPiBpbXBsZW1lbnRzIEVpdGhlcjxUPiB7XG4gIHByaXZhdGUgcmVhZG9ubHkgdmFsdWU6IFQ7XG4gIHByaXZhdGUgcmVhZG9ubHkgdHJhY2VzOiBUcmFjZXM7XG4gIHByaXZhdGUgcmVhZG9ubHkgY29udGV4dHM6IENvbnRleHRzO1xuICBbU3VjY2Vzc1N5bWJvbF0gPSB0cnVlO1xuXG4gIHByaXZhdGUgY29uc3RydWN0b3IodmFsdWU6IFQsIHRyYWNlczogVHJhY2VzLCBjb250ZXh0czogQ29udGV4dHMpIHtcbiAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgdGhpcy50cmFjZXMgPSB0cmFjZXM7XG4gICAgdGhpcy5jb250ZXh0cyA9IGNvbnRleHRzO1xuICB9XG5cbiAgc3RhdGljIG9mKHZhbHVlOiBhbnksIHRyYWNlcz86IFRyYWNlcyB8IG51bGwsIGNvbnRleHRzPzogQ29udGV4dHMgfCBudWxsKSB7XG4gICAgcmV0dXJuIG5ldyBTdWNjZXNzKFxuICAgICAgdmFsdWUsXG4gICAgICB0cmFjZXMgPz8gVHJhY2VDb2xsZWN0aW9uLmVtcHR5KCksXG4gICAgICBjb250ZXh0cyA/PyBDb250ZXh0Q29sbGVjdGlvbi5lbXB0eSgpLFxuICAgICk7XG4gIH1cblxuICBiaW5kKGZuOiAodmFsdWU6IFQpID0+IFJlc3VsdDxUPik6IFJlc3VsdDxUPiB7XG4gICAgcmV0dXJuIGZuKHRoaXMudmFsdWUpO1xuICB9XG5cbiAgbGlmdCh2YWx1ZTogYW55KTogUmVzdWx0PFQ+IHtcbiAgICByZXR1cm4gbmV3IFN1Y2Nlc3ModmFsdWUsIHRoaXMudHJhY2VzLCB0aGlzLmNvbnRleHRzKTtcbiAgfVxuXG4gIG1hcChmbjogKHZhbHVlOiBhbnkpID0+IGFueSk6IFJlc3VsdDxUPiB7XG4gICAgcmV0dXJuIG5ldyBTdWNjZXNzKGZuKHRoaXMudmFsdWUpLCB0aGlzLnRyYWNlcywgdGhpcy5jb250ZXh0cyk7XG4gIH1cblxuICB1bndyYXAoKTogVCB7XG4gICAgcmV0dXJuIHRoaXMudmFsdWU7XG4gIH1cblxuICBnZXRUcmFjZXMoKTogVHJhY2VzIHtcbiAgICByZXR1cm4gdGhpcy50cmFjZXM7XG4gIH1cblxuICB3aXRoVHJhY2UodHJhY2U6IFRyYWNlKTogUmVzdWx0PFQ+IHtcbiAgICB0aGlzLnRyYWNlcy5hZGQodHJhY2UpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgd2l0aENvbnRleHQoa2V5OiBzdHJpbmcsIGNvbnRleHQ6IENvbnRleHQpOiBSZXN1bHQ8VD4ge1xuICAgIHRoaXMuY29udGV4dHMuYWRkKGtleSwgY29udGV4dCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBnZXRDb250ZXh0KGtleTogc3RyaW5nKTogT3B0aW9uYWxSZXN1bHQ8Q29udGV4dD4ge1xuICAgIHJldHVybiB0aGlzLmNvbnRleHRzLmdldChrZXkpO1xuICB9XG5cbiAgZ2V0Q29udGV4dHMoKTogQ29udGV4dHMge1xuICAgIHJldHVybiB0aGlzLmNvbnRleHRzO1xuICB9XG5cbiAgY2xlYXJDb250ZXh0KGtleTogc3RyaW5nKTogUmVzdWx0PFQ+IHtcbiAgICB0aGlzLmNvbnRleHRzLnJlbW92ZShrZXkpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1N1Y2Nlc3M8VD4oXG4gIG9iajogQXN5bmNSZXN1bHQ8VD4gfCBSZXN1bHQ8VD4sXG4pOiBvYmogaXMgU3VjY2VzczxUPiB7XG4gIHJldHVybiBvYmogJiYgKG9iaiBhcyBTdWNjZXNzPFQ+KVtTdWNjZXNzU3ltYm9sXSA9PT0gdHJ1ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFsbFN1Y2Nlc3NmdWw8VD4oXG4gIG9iajogQXN5bmNSZXN1bHQ8YW55PiB8IEFzeW5jUmVzdWx0PGFueT5bXSxcbik6IG9iaiBpcyBTdWNjZXNzPFQ+IHwgU3VjY2VzczxUPltdIHtcbiAgaWYgKEFycmF5LmlzQXJyYXkob2JqKSkge1xuICAgIHJldHVybiBvYmouZXZlcnkoXG4gICAgICAoaXRlbSkgPT4gaXRlbSAmJiAoaXRlbSBhcyBTdWNjZXNzPFQ+KVtTdWNjZXNzU3ltYm9sXSA9PT0gdHJ1ZSxcbiAgICApO1xuICB9XG4gIHJldHVybiBvYmogJiYgKG9iaiBhcyBTdWNjZXNzPFQ+KVtTdWNjZXNzU3ltYm9sXSA9PT0gdHJ1ZTtcbn1cbiIsIi8vIFN0ZXAgMTogQ3JlYXRlIGEgdW5pcXVlIHN5bWJvbCB0byB0YWcgdGhlIGNsYXNzXG5pbXBvcnQgeyBBc3luY1Jlc3VsdCB9IGZyb20gXCJAL21vbmFkL3Jlc3VsdFwiO1xuXG5jb25zdCBBd2FpdGluZ1N5bWJvbCA9IFN5bWJvbChcIkpzTW9uYWRBd2FpdGluZ1N5bWJvbFwiKTtcblxuLy8gU3RlcCAyOiBEZWZpbmUgdGhlIEF3YWl0aW5nIGNsYXNzIGFuZCB0YWcgaXQgd2l0aCB0aGUgc3ltYm9sXG5leHBvcnQgaW50ZXJmYWNlIEF3YWl0aW5nSSB7fVxuXG5leHBvcnQgY2xhc3MgQXdhaXRpbmcgaW1wbGVtZW50cyBBd2FpdGluZ0kge1xuICAvLyBUYWdnaW5nIHRoZSBjbGFzcyB3aXRoIHRoZSBzeW1ib2xcbiAgW0F3YWl0aW5nU3ltYm9sXSA9IHRydWU7XG59XG5cbi8vIFJldHVybnMgJ1RydWUnIHdoZW4gb25lIHZhbHVlIGlzIGluc3RhbmNlIG9mIEF3YWl0aW5nLlxuZXhwb3J0IGZ1bmN0aW9uIGlzQXdhaXRpbmcoXG4gIG9iajogQXN5bmNSZXN1bHQ8YW55PiB8IEFzeW5jUmVzdWx0PGFueT5bXSxcbik6IG9iaiBpcyBBd2FpdGluZyB8IEF3YWl0aW5nW10ge1xuICBpZiAoQXJyYXkuaXNBcnJheShvYmopKSB7XG4gICAgcmV0dXJuIG9iai5zb21lKFxuICAgICAgKGl0ZW0pID0+IGl0ZW0gJiYgKGl0ZW0gYXMgQXdhaXRpbmcpW0F3YWl0aW5nU3ltYm9sXSA9PT0gdHJ1ZSxcbiAgICApO1xuICB9XG4gIHJldHVybiBvYmogJiYgKG9iaiBhcyBBd2FpdGluZylbQXdhaXRpbmdTeW1ib2xdID09PSB0cnVlO1xufVxuIl19