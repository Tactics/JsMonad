'use strict';var react=require('react'),z=require('fast-deep-equal'),jsxRuntime=require('react/jsx-runtime');function _interopDefault(e){return e&&e.__esModule?e:{default:e}}var z__default=/*#__PURE__*/_interopDefault(z);var l=class e{constructor(){this.traces=[];}static empty(){return new e}add(t){let r=new e;return r.traces=[...this.traces,t],r}*[Symbol.iterator](){for(let t of this.traces)yield t;}};var p=class e{constructor(t,r){this.message=t,this.time=r;}static from(t,r){return new e(t,r)}read(){return this.message}at(){return this.time}};var C=Symbol("JsMonadSomeSymbol"),v,f=class e{constructor(t){this[v]=true;this.value=t;}static[(v=C,Symbol.hasInstance)](t){return g(t)}static of(t){return new e(t)}bind(t){return t(this.value)}unwrap(){return this.value}map(t){let r=t(this.value);return e.of(r)}};function g(e){return e&&e[C]===true}var b=Symbol("JsMonadNoneSymbol"),S,x=class e{constructor(){this[S]=true;}static[(S=b,Symbol.hasInstance)](t){return w(t)}static of(){return new e}bind(t){return this}unwrap(){throw new Error("Value of None cannot be unwrapped")}map(t){return this}};function w(e){return e&&e[b]===true}var u=class e{constructor(){this.contexts={};}static empty(){return new e}get(t){return this.contexts[t]?f.of(this.contexts[t]):x.of()}add(t,r){let o=new e;return o.contexts={...this.contexts},o.contexts[t]=r,o}remove(t){let r=new e;return r.contexts={...this.contexts},delete r.contexts[t],r}*[Symbol.iterator](){for(let t in this.contexts)yield this.contexts[t];}};var O=Symbol("JsMonadFailureSymbol"),A,c=class e{constructor(t,r,o,n,s){this[A]=true;this.message=t,this.name="Failure",this.code=r,this.traces=o,this.contexts=n,this.previous=s;}static[(A=O,Symbol.hasInstance)](t){return E(t)}static dueTo(t,r,o,n,s,a){return s=s??l.empty(),n?s.add(n):s.add(p.from(t,Date.now())),a=a??u.empty(),new e(t,r,s,a,o||null)}bind(t){return this}map(t){return this}lift(t){return this}unwrap(){throw new Error("Value of Failure can not be unwrapped")}getTraces(){return this.traces}withTrace(t){return this.traces.add(t),this}withContext(t,r){return this.contexts.add(t,r),this}getContext(t){return this.contexts.get(t)}getContexts(){return this.contexts}clearContext(t){return this.contexts.remove(t),this}};function E(e){return e&&e[O]===true}var N=Symbol("JsMonadSuccessSymbol"),F,i=class e{constructor(t,r,o){this[F]=true;this.value=t,this.traces=r,this.contexts=o;}static[(F=N,Symbol.hasInstance)](t){return I(t)}static of(t,r,o){return new e(t,r??l.empty(),o??u.empty())}bind(t){return t(this.value)}lift(t){return new e(t,this.traces,this.contexts)}map(t){return new e(t(this.value),this.traces,this.contexts)}unwrap(){return this.value}getTraces(){return this.traces}withTrace(t){return this.traces.add(t),this}withContext(t,r){return this.contexts.add(t,r),this}getContext(t){return this.contexts.get(t)}getContexts(){return this.contexts}clearContext(t){return this.contexts.remove(t),this}};function I(e){return e&&e[N]===true}var J=Symbol("JsMonadAwaitingSymbol"),U;U=J;var m=class{constructor(){this[U]=true;}};function L(e){return e&&e[J]===true}function M(e,{onSuccess:t,onFailure:r}){let o=react.useRef(new m);react.useEffect(()=>{let n=o.current,s=n instanceof m&&(e instanceof i||e instanceof c)||n instanceof i&&e instanceof c||n instanceof c&&e instanceof i,a=e instanceof i&&n instanceof i&&!z__default.default(n.unwrap(),e.unwrap());(s||a)&&(e instanceof i&&t&&t(e),e instanceof c&&r&&r(e)),o.current=e;},[e,t,r]);}var V=M;function B({asyncResult:e,onLoading:t,onError:r,onSuccess:o}){let[n,s]=react.useState(null),[a,k]=react.useState(false),[D,R]=react.useState(true);return V(e,{onSuccess:T=>{s(T),R(false);},onFailure:T=>{k(T),R(false);}}),D||!n?jsxRuntime.jsx(jsxRuntime.Fragment,{children:t}):a?jsxRuntime.jsx(jsxRuntime.Fragment,{children:r(a)}):jsxRuntime.jsx(jsxRuntime.Fragment,{children:o(n)})}exports.AsyncResultSuspense=B;exports.Awaiting=m;exports.ContextCollection=u;exports.Failure=c;exports.None=x;exports.Some=f;exports.Success=i;exports.TraceCollection=l;exports.TraceCommon=p;exports.isAwaiting=L;exports.isFailure=E;exports.isNone=w;exports.isSome=g;exports.isSuccess=I;exports.useEffectAsyncResult=M;//# sourceMappingURL=index.js.map
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9tb25hZC90cmFjZS90cmFjZS1jb2xsZWN0aW9uLnRzIiwiLi4vc3JjL21vbmFkL3RyYWNlL3RyYWNlLWNvbW1vbi50cyIsIi4uL3NyYy9tb25hZC9tb25hZHMvb3B0aW9uYWwvc29tZS50cyIsIi4uL3NyYy9tb25hZC9tb25hZHMvb3B0aW9uYWwvbm9uZS50cyIsIi4uL3NyYy9tb25hZC9jb250ZXh0L2NvbnRleHQtY29sbGVjdGlvbi50cyIsIi4uL3NyYy9tb25hZC9tb25hZHMvZWl0aGVyL2ZhaWx1cmUudHMiLCIuLi9zcmMvbW9uYWQvbW9uYWRzL2VpdGhlci9zdWNjZXNzLnRzIiwiLi4vc3JjL21vbmFkL2F3YWl0aW5nLnRzIiwiLi4vc3JjL21vbmFkL2hvb2tzL3VzZS1lZmZlY3QtYXN5bmMtcmVzdWx0LnRzeCIsIi4uL3NyYy9tb25hZC9jb21wb25lbnRzL2FzeW5jLXJlc3VsdC1zdXNwZW5zZS50c3giXSwibmFtZXMiOlsiVHJhY2VDb2xsZWN0aW9uIiwiX1RyYWNlQ29sbGVjdGlvbiIsInRyYWNlIiwibmV3Q29sbGVjdGlvbiIsIlRyYWNlQ29tbW9uIiwiX1RyYWNlQ29tbW9uIiwibWVzc2FnZSIsInRpbWUiLCJTb21lU3ltYm9sIiwiX2EiLCJTb21lIiwiX1NvbWUiLCJ2YWx1ZSIsIm9iaiIsImlzU29tZSIsImZuIiwibmV3VmFsdWUiLCJOb25lU3ltYm9sIiwiTm9uZSIsIl9Ob25lIiwiaXNOb25lIiwiQ29udGV4dENvbGxlY3Rpb24iLCJfQ29udGV4dENvbGxlY3Rpb24iLCJrZXkiLCJjb250ZXh0IiwiRmFpbHVyZVN5bWJvbCIsIkZhaWx1cmUiLCJfRmFpbHVyZSIsImNvZGUiLCJ0cmFjZXMiLCJjb250ZXh0cyIsInByZXZpb3VzIiwiaXNGYWlsdXJlIiwiU3VjY2Vzc1N5bWJvbCIsIlN1Y2Nlc3MiLCJfU3VjY2VzcyIsImlzU3VjY2VzcyIsIkF3YWl0aW5nU3ltYm9sIiwiQXdhaXRpbmciLCJpc0F3YWl0aW5nIiwidXNlRWZmZWN0QXN5bmNSZXN1bHQiLCJyZXN1bHQiLCJvblN1Y2Nlc3MiLCJvbkZhaWx1cmUiLCJwcmV2aW91c1JlZiIsInVzZVJlZiIsInVzZUVmZmVjdCIsImhhc1N0YXR1c0NoYW5nZWQiLCJoYXNWYWx1ZUNoYW5nZWQiLCJpc0VxdWFsIiwidXNlX2VmZmVjdF9hc3luY19yZXN1bHRfZGVmYXVsdCIsIkFzeW5jUmVzdWx0U3VzcGVuc2UiLCJhc3luY1Jlc3VsdCIsIm9uTG9hZGluZyIsIm9uRXJyb3IiLCJkYXRhIiwic2V0RGF0YSIsInVzZVN0YXRlIiwiZXJyb3IiLCJzZXRFcnJvciIsImxvYWRpbmciLCJzZXRMb2FkaW5nIiwianN4IiwiRnJhZ21lbnQiXSwibWFwcGluZ3MiOiI2TkFJYUEsSUFBQUEsQ0FBQUEsQ0FBTixNQUFNQyxDQUFrQyxDQUdyQyxXQUFBLEVBQWMsQ0FGdEIsSUFBVSxDQUFBLE1BQUEsQ0FBa0IsR0FFTCxDQUV2QixPQUFjLE9BQXlCLENBQ3JDLE9BQU8sSUFBSUEsQ0FDYixDQUVPLEdBQUEsQ0FBSUMsRUFBK0IsQ0FDeEMsSUFBTUMsQ0FBZ0IsQ0FBQSxJQUFJRixDQUMxQixDQUFBLE9BQUFFLEVBQWMsTUFBUyxDQUFBLENBQUMsR0FBRyxJQUFBLENBQUssTUFBUUQsQ0FBQUEsQ0FBSyxFQUN0Q0MsQ0FDVCxDQUVBLEVBQVMsTUFBQSxDQUFPLFFBQVEsQ0FBQSxFQUFxQixDQUMzQyxJQUFXRCxJQUFBQSxDQUFBQSxJQUFTLElBQUssQ0FBQSxNQUFBLENBQ3ZCLE1BQU1BLEVBRVYsQ0FDRixFQ3JCYUUsSUFBQUEsQ0FBQUEsQ0FBTixNQUFNQyxDQUE2QixDQUloQyxXQUFBLENBQVlDLEVBQWlCQyxDQUFjLENBQUEsQ0FDakQsSUFBSyxDQUFBLE9BQUEsQ0FBVUQsQ0FDZixDQUFBLElBQUEsQ0FBSyxLQUFPQyxFQUNkLENBRUEsT0FBYyxJQUFBLENBQUtELENBQWlCQyxDQUFBQSxDQUFBQSxDQUEyQixDQUM3RCxPQUFPLElBQUlGLENBQVlDLENBQUFBLENBQUFBLENBQVNDLENBQUks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TSxDQUFDYSxFQUFNQyxDQUFPLENBQUEsQ0FBSUMsY0FBNEIsQ0FBQSxJQUFJLENBQ2xELENBQUEsQ0FBQ0MsQ0FBT0MsQ0FBQUEsQ0FBUSxDQUFJRixDQUFBQSxjQUFBQSxDQUEwQixLQUFLLENBQUEsQ0FDbkQsQ0FBQ0csQ0FBQUEsQ0FBU0MsQ0FBVSxDQUFJSixDQUFBQSxjQUFBQSxDQUFrQixJQUFJLENBQUEsQ0FhcEQsT0FYQVAsQ0FBQUEsQ0FBd0JFLEVBQWEsQ0FDbkMsU0FBQSxDQUFZRyxDQUFTLEVBQUEsQ0FDbkJDLENBQVFELENBQUFBLENBQUksRUFDWk0sQ0FBVyxDQUFBLEtBQUssRUFDbEIsQ0FBQSxDQUNBLFNBQVlILENBQUFBLENBQUFBLEVBQVUsQ0FDcEJDLENBQUFBLENBQVNELENBQUssQ0FBQSxDQUNkRyxDQUFXLENBQUEsS0FBSyxFQUNsQixDQUNGLENBQUMsQ0FFR0QsQ0FBQUEsQ0FBQUEsRUFBVyxDQUFDTCxDQUFBQSxDQUNQTyxjQUFBQyxDQUFBQSxtQkFBQUEsQ0FBQSxDQUFHLFFBQUFWLENBQUFBLENBQUFBLENBQVUsQ0FHbEJLLENBQUFBLENBQUFBLENBQ0tJLGNBQUFDLENBQUFBLG1CQUFBQSxDQUFBLENBQUcsUUFBQVQsQ0FBQUEsQ0FBQUEsQ0FBUUksQ0FBSyxDQUFBLENBQUUsQ0FHcEJJLENBQUFBLGNBQUFBLENBQUFDLG1CQUFBLENBQUEsQ0FBRyxRQUFBckIsQ0FBQUEsQ0FBQUEsQ0FBVWEsQ0FBSSxDQUFBLENBQUUsQ0FDNUIiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBJbXBsZW1lbnQgdGhlIFRyYWNlQ29sbGVjdGlvbiBjbGFzc1xuaW1wb3J0IHsgVHJhY2VzIH0gZnJvbSBcIkAvbW9uYWQvdHJhY2UvdHJhY2VzXCI7XG5pbXBvcnQgeyBUcmFjZSB9IGZyb20gXCJAL21vbmFkL3RyYWNlL3RyYWNlXCI7XG5cbmV4cG9ydCBjbGFzcyBUcmFjZUNvbGxlY3Rpb24gaW1wbGVtZW50cyBUcmFjZXMge1xuICBwcm90ZWN0ZWQgdHJhY2VzOiBUcmFjZVtdID0gW107XG5cbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHt9XG5cbiAgcHVibGljIHN0YXRpYyBlbXB0eSgpOiBUcmFjZUNvbGxlY3Rpb24ge1xuICAgIHJldHVybiBuZXcgVHJhY2VDb2xsZWN0aW9uKCk7XG4gIH1cblxuICBwdWJsaWMgYWRkKHRyYWNlOiBUcmFjZSk6IFRyYWNlQ29sbGVjdGlvbiB7XG4gICAgY29uc3QgbmV3Q29sbGVjdGlvbiA9IG5ldyBUcmFjZUNvbGxlY3Rpb24oKTtcbiAgICBuZXdDb2xsZWN0aW9uLnRyYWNlcyA9IFsuLi50aGlzLnRyYWNlcywgdHJhY2VdO1xuICAgIHJldHVybiBuZXdDb2xsZWN0aW9uO1xuICB9XG5cbiAgcHVibGljICpbU3ltYm9sLml0ZXJhdG9yXSgpOiBJdGVyYXRvcjxUcmFjZT4ge1xuICAgIGZvciAoY29uc3QgdHJhY2Ugb2YgdGhpcy50cmFjZXMpIHtcbiAgICAgIHlpZWxkIHRyYWNlO1xuICAgIH1cbiAgfVxufVxuIiwiLy8gSW1wbGVtZW50IHRoZSBUcmFjZUNvbW1vbiBjbGFzc1xuaW1wb3J0IHsgVHJhY2UgfSBmcm9tIFwiQC9tb25hZC90cmFjZS90cmFjZVwiO1xuXG5leHBvcnQgY2xhc3MgVHJhY2VDb21tb24gaW1wbGVtZW50cyBUcmFjZSB7XG4gIHByaXZhdGUgcmVhZG9ubHkgbWVzc2FnZTogc3RyaW5nO1xuICBwcml2YXRlIHJlYWRvbmx5IHRpbWU6IG51bWJlcjtcblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKG1lc3NhZ2U6IHN0cmluZywgdGltZTogbnVtYmVyKSB7XG4gICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcbiAgICB0aGlzLnRpbWUgPSB0aW1lO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBmcm9tKG1lc3NhZ2U6IHN0cmluZywgdGltZTogbnVtYmVyKTogVHJhY2VDb21tb24ge1xuICAgIHJldHVybiBuZXcgVHJhY2VDb21tb24obWVzc2FnZSwgdGltZSk7XG4gIH1cblxuICBwdWJsaWMgcmVhZCgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLm1lc3NhZ2U7XG4gIH1cblxuICBwdWJsaWMgYXQoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy50aW1lO1xuICB9XG59XG4iLCJpbXBvcnQgeyBPcHRpb25hbCB9IGZyb20gXCJAL21vbmFkL29wdGlvbmFsXCI7XG5pbXBvcnQgeyBBc3luY09wdGlvbmFsUmVzdWx0LCBPcHRpb25hbFJlc3VsdCB9IGZyb20gXCJAL21vbmFkL3Jlc3VsdFwiO1xuaW1wb3J0IHsgaXNOb25lLCBOb25lIH0gZnJvbSBcIkAvbW9uYWQvbW9uYWRzL29wdGlvbmFsL25vbmVcIjtcblxuY29uc3QgU29tZVN5bWJvbCA9IFN5bWJvbChcIkpzTW9uYWRTb21lU3ltYm9sXCIpO1xuXG5leHBvcnQgY2xhc3MgU29tZTxUPiBpbXBsZW1lbnRzIE9wdGlvbmFsPFQ+IHtcbiAgcHJpdmF0ZSByZWFkb25seSB2YWx1ZTogVDtcblxuICBbU29tZVN5bWJvbF0gPSB0cnVlO1xuXG4gIHN0YXRpYyBbU3ltYm9sLmhhc0luc3RhbmNlXShvYmo6IGFueSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBpc1NvbWUob2JqKTtcbiAgfVxuXG4gIHByaXZhdGUgY29uc3RydWN0b3IodmFsdWU6IFQpIHtcbiAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gIH1cblxuICBzdGF0aWMgb2Y8VD4odmFsdWU6IFQpOiBTb21lPFQ+IHtcbiAgICByZXR1cm4gbmV3IFNvbWUodmFsdWUpO1xuICB9XG5cbiAgYmluZDxVPihmbjogKHZhbHVlOiBUKSA9PiBPcHRpb25hbDxVPik6IE9wdGlvbmFsPFU+IHtcbiAgICByZXR1cm4gZm4odGhpcy52YWx1ZSk7XG4gIH1cblxuICB1bndyYXAoKTogVCB7XG4gICAgcmV0dXJuIHRoaXMudmFsdWU7XG4gIH1cblxuICBtYXA8VT4oZm46ICh2YWx1ZTogVCkgPT4gVSk6IE9wdGlvbmFsPFU+IHtcbiAgICBjb25zdCBuZXdWYWx1ZSA9IGZuKHRoaXMudmFsdWUpO1xuICAgIHJldHVybiBTb21lLm9mKG5ld1ZhbHVlKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNTb21lPFQ+KFxuICBvYmo6IE9wdGlvbmFsUmVzdWx0PGFueT4gfCBBc3luY09wdGlvbmFsUmVzdWx0PGFueT4sXG4pOiBvYmogaXMgU29tZTxUPiB7XG4gIHJldHVybiBvYmogJiYgKG9iaiBhcyBTb21lPFQ+KVtTb21lU3ltYm9sXSA9PT0gdHJ1ZTtcbn1cbiIsIi8vIERlZmluZSB0aGUgTm9uZSBjbGFzcyBpbXBsZW1lbnRpbmcgdGhlIE9wdGlvbmFsIGludGVyZmFjZVxuaW1wb3J0IHsgT3B0aW9uYWwgfSBmcm9tIFwiQC9tb25hZC9vcHRpb25hbFwiO1xuaW1wb3J0IHsgQXN5bmNPcHRpb25hbFJlc3VsdCwgT3B0aW9uYWxSZXN1bHQgfSBmcm9tIFwiQC9tb25hZC9yZXN1bHRcIjtcbmltcG9ydCB7IGlzRmFpbHVyZSB9IGZyb20gXCJAL21vbmFkL21vbmFkcy9laXRoZXIvZmFpbHVyZVwiO1xuXG5jb25zdCBOb25lU3ltYm9sID0gU3ltYm9sKFwiSnNNb25hZE5vbmVTeW1ib2xcIik7XG5cbmV4cG9ydCBjbGFzcyBOb25lIGltcGxlbWVudHMgT3B0aW9uYWw8bmV2ZXI+IHtcbiAgW05vbmVTeW1ib2xdID0gdHJ1ZTtcblxuICBzdGF0aWMgW1N5bWJvbC5oYXNJbnN0YW5jZV0ob2JqOiBhbnkpOiBib29sZWFuIHtcbiAgICByZXR1cm4gaXNOb25lKG9iaik7XG4gIH1cblxuICBzdGF0aWMgb2YoKTogTm9uZSB7XG4gICAgcmV0dXJuIG5ldyBOb25lKCk7XG4gIH1cblxuICBiaW5kKGZuOiAodmFsdWU6IG5ldmVyKSA9PiBPcHRpb25hbDxuZXZlcj4pOiBOb25lIHtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHVud3JhcCgpOiBuZXZlciB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiVmFsdWUgb2YgTm9uZSBjYW5ub3QgYmUgdW53cmFwcGVkXCIpO1xuICB9XG5cbiAgbWFwPFU+KGZuOiAodmFsdWU6IG5ldmVyKSA9PiBVKTogTm9uZSB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzTm9uZTxUPihcbiAgb2JqOiBPcHRpb25hbFJlc3VsdDxUPiB8IEFzeW5jT3B0aW9uYWxSZXN1bHQ8VD4sXG4pOiBvYmogaXMgTm9uZSB7XG4gIHJldHVybiBvYmogJiYgKG9iaiBhcyBOb25lKVtOb25lU3ltYm9sXSA9PT0gdHJ1ZTtcbn1cbiIsImltcG9ydCB7IENvbnRleHRzIH0gZnJvbSBcIkAvbW9uYWQvY29udGV4dC9jb250ZXh0c1wiO1xuaW1wb3J0IHsgQ29udGV4dCB9IGZyb20gXCJAL21vbmFkL2NvbnRleHQvY29udGV4dFwiO1xuaW1wb3J0IHsgT3B0aW9uYWxSZXN1bHQgfSBmcm9tIFwiQC9tb25hZC9yZXN1bHRcIjtcbmltcG9ydCB7IFNvbWUgfSBmcm9tIFwiQC9tb25hZC9tb25hZHMvb3B0aW9uYWwvc29tZVwiO1xuaW1wb3J0IHsgTm9uZSB9IGZyb20gXCJAL21vbmFkL21vbmFkcy9vcHRpb25hbC9ub25lXCI7XG5cbmV4cG9ydCBjbGFzcyBDb250ZXh0Q29sbGVjdGlvbiBpbXBsZW1lbnRzIENvbnRleHRzIHtcbiAgcHJpdmF0ZSBjb250ZXh0czogeyBba2V5OiBzdHJpbmddOiBDb250ZXh0IH0gPSB7fTtcblxuICBzdGF0aWMgZW1wdHkoKTogQ29udGV4dENvbGxlY3Rpb24ge1xuICAgIHJldHVybiBuZXcgQ29udGV4dENvbGxlY3Rpb24oKTtcbiAgfVxuXG4gIGdldChrZXk6IHN0cmluZyk6IE9wdGlvbmFsUmVzdWx0PENvbnRleHQ+IHtcbiAgICByZXR1cm4gdGhpcy5jb250ZXh0c1trZXldID8gU29tZS5vZih0aGlzLmNvbnRleHRzW2tleV0pIDogTm9uZS5vZigpO1xuICB9XG5cbiAgYWRkKGtleTogc3RyaW5nLCBjb250ZXh0OiBDb250ZXh0KTogQ29udGV4dENvbGxlY3Rpb24ge1xuICAgIGNvbnN0IG5ld0NvbGxlY3Rpb24gPSBuZXcgQ29udGV4dENvbGxlY3Rpb24oKTtcbiAgICBuZXdDb2xsZWN0aW9uLmNvbnRleHRzID0geyAuLi50aGlzLmNvbnRleHRzIH07XG4gICAgbmV3Q29sbGVjdGlvbi5jb250ZXh0c1trZXldID0gY29udGV4dDtcbiAgICByZXR1cm4gbmV3Q29sbGVjdGlvbjtcbiAgfVxuXG4gIHJlbW92ZShrZXk6IHN0cmluZyk6IENvbnRleHRDb2xsZWN0aW9uIHtcbiAgICBjb25zdCBuZXdDb2xsZWN0aW9uID0gbmV3IENvbnRleHRDb2xsZWN0aW9uKCk7XG4gICAgbmV3Q29sbGVjdGlvbi5jb250ZXh0cyA9IHsgLi4udGhpcy5jb250ZXh0cyB9O1xuICAgIGRlbGV0ZSBuZXdDb2xsZWN0aW9uLmNvbnRleHRzW2tleV07XG4gICAgcmV0dXJuIG5ld0NvbGxlY3Rpb247XG4gIH1cblxuICAqW1N5bWJvbC5pdGVyYXRvcl0oKTogSXRlcmF0b3I8Q29udGV4dD4ge1xuICAgIGZvciAoY29uc3Qga2V5IGluIHRoaXMuY29udGV4dHMpIHtcbiAgICAgIHlpZWxkIHRoaXMuY29udGV4dHNba2V5XTtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCB7IEVpdGhlciB9IGZyb20gXCJAL21vbmFkL2VpdGhlclwiO1xuaW1wb3J0IHsgQXN5bmNSZXN1bHQsIE9wdGlvbmFsUmVzdWx0LCBSZXN1bHQgfSBmcm9tIFwiQC9tb25hZC9yZXN1bHRcIjtcbmltcG9ydCB7IFRyYWNlcyB9IGZyb20gXCJAL21vbmFkL3RyYWNlL3RyYWNlc1wiO1xuaW1wb3J0IHsgVHJhY2UgfSBmcm9tIFwiQC9tb25hZC90cmFjZS90cmFjZVwiO1xuaW1wb3J0IHsgQ29udGV4dHMgfSBmcm9tIFwiQC9tb25hZC9jb250ZXh0L2NvbnRleHRzXCI7XG5pbXBvcnQgeyBDb250ZXh0IH0gZnJvbSBcIkAvbW9uYWQvY29udGV4dC9jb250ZXh0XCI7XG5pbXBvcnQgeyBUcmFjZUNvbGxlY3Rpb24gfSBmcm9tIFwiQC9tb25hZC90cmFjZS90cmFjZS1jb2xsZWN0aW9uXCI7XG5pbXBvcnQgeyBUcmFjZUNvbW1vbiB9IGZyb20gXCJAL21vbmFkL3RyYWNlL3RyYWNlLWNvbW1vblwiO1xuaW1wb3J0IHsgQ29udGV4dENvbGxlY3Rpb24gfSBmcm9tIFwiQC9tb25hZC9jb250ZXh0L2NvbnRleHQtY29sbGVjdGlvblwiO1xuaW1wb3J0IHsgaXNTdWNjZXNzIH0gZnJvbSBcIkAvbW9uYWQvbW9uYWRzL2VpdGhlci9zdWNjZXNzXCI7XG5cbmNvbnN0IEZhaWx1cmVTeW1ib2wgPSBTeW1ib2woXCJKc01vbmFkRmFpbHVyZVN5bWJvbFwiKTtcblxuZXhwb3J0IGNsYXNzIEZhaWx1cmUgaW1wbGVtZW50cyBFaXRoZXI8bmV2ZXI+LCBFcnJvciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgdHJhY2VzOiBUcmFjZXM7XG4gIHByaXZhdGUgcmVhZG9ubHkgY29udGV4dHM6IENvbnRleHRzO1xuICBtZXNzYWdlOiBzdHJpbmc7XG4gIGNvZGU6IHN0cmluZztcbiAgbmFtZTogc3RyaW5nO1xuICBwcmV2aW91czogRXJyb3IgfCBudWxsO1xuXG4gIFtGYWlsdXJlU3ltYm9sXSA9IHRydWU7XG5cbiAgc3RhdGljIFtTeW1ib2wuaGFzSW5zdGFuY2VdKG9iajogYW55KTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIGlzRmFpbHVyZShvYmopO1xuICB9XG5cbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvcihcbiAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgY29kZTogc3RyaW5nLFxuICAgIHRyYWNlczogVHJhY2VzLFxuICAgIGNvbnRleHRzOiBDb250ZXh0cyxcbiAgICBwcmV2aW91czogRXJyb3IgfCBudWxsLFxuICApIHtcbiAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgIHRoaXMubmFtZSA9IFwiRmFpbHVyZVwiO1xuICAgIHRoaXMuY29kZSA9IGNvZGU7XG4gICAgdGhpcy50cmFjZXMgPSB0cmFjZXM7XG4gICAgdGhpcy5jb250ZXh0cyA9IGNvbnRleHRzO1xuICAgIHRoaXMucHJldmlvdXMgPSBwcmV2aW91cztcbiAgfVxuXG4gIHN0YXRpYyBkdWVUbyhcbiAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgY29kZTogc3RyaW5nLFxuICAgIHByZXZpb3VzPzogRXJyb3IgfCBudWxsLFxuICAgIHRyYWNlPzogVHJhY2UgfCBudWxsLFxuICAgIHRyYWNlcz86IFRyYWNlcyB8IG51bGwsXG4gICAgY29udGV4dHM/OiBDb250ZXh0cyB8IG51bGwsXG4gICk6IEZhaWx1cmUge1xuICAgIC8vIEFkZCBGYWlsdXJlIHRyYWNlcyBhcyBsYXN0IGl0ZW0uXG4gICAgdHJhY2VzID0gdHJhY2VzID8/IFRyYWNlQ29sbGVjdGlvbi5lbXB0eSgpO1xuICAgIGlmICh0cmFjZSkge1xuICAgICAgdHJhY2VzLmFkZCh0cmFjZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEZhbGxiYWNrIHRvIGEgY29tbW9uIHRyYWNlIG9mIHRoZSBtZXNzYWdlIHdoZW4gbm8gc3BlY2lmaWMgdHJhY2Ugd2FzIHByb3ZpZGVkLlxuICAgICAgdHJhY2VzLmFkZChUcmFjZUNvbW1vbi5mcm9tKG1lc3NhZ2UsIERhdGUubm93KCkpKTtcbiAgICB9XG5cbiAgICBjb250ZXh0cyA9IGNvbnRleHRzID8/IENvbnRleHRDb2xsZWN0aW9uLmVtcHR5KCk7XG4gICAgcmV0dXJuIG5ldyBGYWlsdXJlKFxuICAgICAgbWVzc2FnZSxcbiAgICAgIGNvZGUsXG4gICAgICB0cmFjZXMsXG4gICAgICBjb250ZXh0cyxcbiAgICAgIHByZXZpb3VzID8gcHJldmlvdXMgOiBudWxsLFxuICAgICk7XG4gIH1cblxuICBiaW5kKGZuOiAodmFsdWU6IG5ldmVyKSA9PiBSZXN1bHQ8bmV2ZXI+KTogUmVzdWx0PG5ldmVyPiB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBtYXAoZm46ICh2YWx1ZTogbmV2ZXIpID0+IG5ldmVyKTogUmVzdWx0PG5ldmVyPiB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBsaWZ0KHZhbHVlOiBuZXZlcik6IFJlc3VsdDxuZXZlcj4ge1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgdW53cmFwKCk6IG5ldmVyIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJWYWx1ZSBvZiBGYWlsdXJlIGNhbiBub3QgYmUgdW53cmFwcGVkXCIpO1xuICB9XG5cbiAgZ2V0VHJhY2VzKCk6IFRyYWNlcyB7XG4gICAgcmV0dXJuIHRoaXMudHJhY2VzO1xuICB9XG5cbiAgd2l0aFRyYWNlKHRyYWNlOiBUcmFjZSk6IFJlc3VsdDxuZXZlcj4ge1xuICAgIHRoaXMudHJhY2VzLmFkZCh0cmFjZSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICB3aXRoQ29udGV4dChrZXk6IHN0cmluZywgY29udGV4dDogQ29udGV4dCk6IFJlc3VsdDxuZXZlcj4ge1xuICAgIHRoaXMuY29udGV4dHMuYWRkKGtleSwgY29udGV4dCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBnZXRDb250ZXh0KGtleTogc3RyaW5nKTogT3B0aW9uYWxSZXN1bHQ8Q29udGV4dD4ge1xuICAgIHJldHVybiB0aGlzLmNvbnRleHRzLmdldChrZXkpO1xuICB9XG5cbiAgZ2V0Q29udGV4dHMoKTogQ29udGV4dHMge1xuICAgIHJldHVybiB0aGlzLmNvbnRleHRzO1xuICB9XG5cbiAgY2xlYXJDb250ZXh0KGtleTogc3RyaW5nKTogUmVzdWx0PG5ldmVyPiB7XG4gICAgdGhpcy5jb250ZXh0cy5yZW1vdmUoa2V5KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNGYWlsdXJlPFQ+KG9iajogQXN5bmNSZXN1bHQ8VD4gfCBSZXN1bHQ8VD4pOiBvYmogaXMgRmFpbHVyZSB7XG4gIHJldHVybiBvYmogJiYgKG9iaiBhcyBGYWlsdXJlKVtGYWlsdXJlU3ltYm9sXSA9PT0gdHJ1ZTtcbn1cbiIsImltcG9ydCB7IEVpdGhlciB9IGZyb20gXCJAL21vbmFkL2VpdGhlclwiO1xuaW1wb3J0IHsgQXN5bmNSZXN1bHQsIE9wdGlvbmFsUmVzdWx0LCBSZXN1bHQgfSBmcm9tIFwiQC9tb25hZC9yZXN1bHRcIjtcbmltcG9ydCB7IENvbnRleHRzIH0gZnJvbSBcIkAvbW9uYWQvY29udGV4dC9jb250ZXh0c1wiO1xuaW1wb3J0IHsgVHJhY2VzIH0gZnJvbSBcIkAvbW9uYWQvdHJhY2UvdHJhY2VzXCI7XG5pbXBvcnQgeyBUcmFjZSB9IGZyb20gXCJAL21vbmFkL3RyYWNlL3RyYWNlXCI7XG5pbXBvcnQgeyBDb250ZXh0IH0gZnJvbSBcIkAvbW9uYWQvY29udGV4dC9jb250ZXh0XCI7XG5pbXBvcnQgeyBUcmFjZUNvbGxlY3Rpb24gfSBmcm9tIFwiQC9tb25hZC90cmFjZS90cmFjZS1jb2xsZWN0aW9uXCI7XG5pbXBvcnQgeyBDb250ZXh0Q29sbGVjdGlvbiB9IGZyb20gXCJAL21vbmFkL2NvbnRleHQvY29udGV4dC1jb2xsZWN0aW9uXCI7XG5pbXBvcnQgeyBGYWlsdXJlIH0gZnJvbSBcIkAvbW9uYWQvbW9uYWRzL2VpdGhlci9mYWlsdXJlXCI7XG5cbmNvbnN0IFN1Y2Nlc3NTeW1ib2wgPSBTeW1ib2woXCJKc01vbmFkU3VjY2Vzc1N5bWJvbFwiKTtcblxuZXhwb3J0IGNsYXNzIFN1Y2Nlc3M8VD4gaW1wbGVtZW50cyBFaXRoZXI8VD4ge1xuICBwcml2YXRlIHJlYWRvbmx5IHZhbHVlOiBUO1xuICBwcml2YXRlIHJlYWRvbmx5IHRyYWNlczogVHJhY2VzO1xuICBwcml2YXRlIHJlYWRvbmx5IGNvbnRleHRzOiBDb250ZXh0cztcbiAgW1N1Y2Nlc3NTeW1ib2xdID0gdHJ1ZTtcblxuICBzdGF0aWMgW1N5bWJvbC5oYXNJbnN0YW5jZV0ob2JqOiBhbnkpOiBib29sZWFuIHtcbiAgICByZXR1cm4gaXNTdWNjZXNzKG9iaik7XG4gIH1cblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKHZhbHVlOiBULCB0cmFjZXM6IFRyYWNlcywgY29udGV4dHM6IENvbnRleHRzKSB7XG4gICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgIHRoaXMudHJhY2VzID0gdHJhY2VzO1xuICAgIHRoaXMuY29udGV4dHMgPSBjb250ZXh0cztcbiAgfVxuXG4gIHN0YXRpYyBvZih2YWx1ZTogYW55LCB0cmFjZXM/OiBUcmFjZXMgfCBudWxsLCBjb250ZXh0cz86IENvbnRleHRzIHwgbnVsbCkge1xuICAgIHJldHVybiBuZXcgU3VjY2VzcyhcbiAgICAgIHZhbHVlLFxuICAgICAgdHJhY2VzID8/IFRyYWNlQ29sbGVjdGlvbi5lbXB0eSgpLFxuICAgICAgY29udGV4dHMgPz8gQ29udGV4dENvbGxlY3Rpb24uZW1wdHkoKSxcbiAgICApO1xuICB9XG5cbiAgYmluZChmbjogKHZhbHVlOiBUKSA9PiBSZXN1bHQ8VD4pOiBSZXN1bHQ8VD4ge1xuICAgIHJldHVybiBmbih0aGlzLnZhbHVlKTtcbiAgfVxuXG4gIGxpZnQodmFsdWU6IGFueSk6IFJlc3VsdDxUPiB7XG4gICAgcmV0dXJuIG5ldyBTdWNjZXNzKHZhbHVlLCB0aGlzLnRyYWNlcywgdGhpcy5jb250ZXh0cyk7XG4gIH1cblxuICBtYXAoZm46ICh2YWx1ZTogYW55KSA9PiBhbnkpOiBSZXN1bHQ8VD4ge1xuICAgIHJldHVybiBuZXcgU3VjY2Vzcyhmbih0aGlzLnZhbHVlKSwgdGhpcy50cmFjZXMsIHRoaXMuY29udGV4dHMpO1xuICB9XG5cbiAgdW53cmFwKCk6IFQge1xuICAgIHJldHVybiB0aGlzLnZhbHVlO1xuICB9XG5cbiAgZ2V0VHJhY2VzKCk6IFRyYWNlcyB7XG4gICAgcmV0dXJuIHRoaXMudHJhY2VzO1xuICB9XG5cbiAgd2l0aFRyYWNlKHRyYWNlOiBUcmFjZSk6IFJlc3VsdDxUPiB7XG4gICAgdGhpcy50cmFjZXMuYWRkKHRyYWNlKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHdpdGhDb250ZXh0KGtleTogc3RyaW5nLCBjb250ZXh0OiBDb250ZXh0KTogUmVzdWx0PFQ+IHtcbiAgICB0aGlzLmNvbnRleHRzLmFkZChrZXksIGNvbnRleHQpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgZ2V0Q29udGV4dChrZXk6IHN0cmluZyk6IE9wdGlvbmFsUmVzdWx0PENvbnRleHQ+IHtcbiAgICByZXR1cm4gdGhpcy5jb250ZXh0cy5nZXQoa2V5KTtcbiAgfVxuXG4gIGdldENvbnRleHRzKCk6IENvbnRleHRzIHtcbiAgICByZXR1cm4gdGhpcy5jb250ZXh0cztcbiAgfVxuXG4gIGNsZWFyQ29udGV4dChrZXk6IHN0cmluZyk6IFJlc3VsdDxUPiB7XG4gICAgdGhpcy5jb250ZXh0cy5yZW1vdmUoa2V5KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNTdWNjZXNzPFQ+KFxuICBvYmo6IEFzeW5jUmVzdWx0PFQ+IHwgUmVzdWx0PFQ+LFxuKTogb2JqIGlzIFN1Y2Nlc3M8VD4ge1xuICByZXR1cm4gb2JqICYmIChvYmogYXMgU3VjY2VzczxUPilbU3VjY2Vzc1N5bWJvbF0gPT09IHRydWU7XG59XG4iLCIvLyBTdGVwIDE6IENyZWF0ZSBhIHVuaXF1ZSBzeW1ib2wgdG8gdGFnIHRoZSBjbGFzc1xuaW1wb3J0IHsgQXN5bmNSZXN1bHQsIFJlc3VsdCB9IGZyb20gXCJAL21vbmFkL3Jlc3VsdFwiO1xuaW1wb3J0IHsgU3VjY2VzcyB9IGZyb20gXCJAL21vbmFkL21vbmFkcy9laXRoZXIvc3VjY2Vzc1wiO1xuXG5jb25zdCBBd2FpdGluZ1N5bWJvbCA9IFN5bWJvbChcIkpzTW9uYWRBd2FpdGluZ1N5bWJvbFwiKTtcblxuLy8gU3RlcCAyOiBEZWZpbmUgdGhlIEF3YWl0aW5nIGNsYXNzIGFuZCB0YWcgaXQgd2l0aCB0aGUgc3ltYm9sXG5leHBvcnQgaW50ZXJmYWNlIEF3YWl0aW5nSSB7fVxuXG5leHBvcnQgY2xhc3MgQXdhaXRpbmcgaW1wbGVtZW50cyBBd2FpdGluZ0kge1xuICAvLyBUYWdnaW5nIHRoZSBjbGFzcyB3aXRoIHRoZSBzeW1ib2xcbiAgW0F3YWl0aW5nU3ltYm9sXSA9IHRydWU7XG59XG5cbi8vIFJldHVybnMgJ1RydWUnIHdoZW4gb25lIHZhbHVlIGlzIGluc3RhbmNlIG9mIEF3YWl0aW5nLlxuZXhwb3J0IGZ1bmN0aW9uIGlzQXdhaXRpbmc8VD4ob2JqOiBBc3luY1Jlc3VsdDxUPik6IG9iaiBpcyBBd2FpdGluZyB7XG4gIHJldHVybiBvYmogJiYgKG9iaiBhcyBBd2FpdGluZylbQXdhaXRpbmdTeW1ib2xdID09PSB0cnVlO1xufVxuIiwiaW1wb3J0IHsgdXNlRWZmZWN0LCB1c2VSZWYgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IEFzeW5jUmVzdWx0IH0gZnJvbSBcIkAvbW9uYWQvcmVzdWx0XCI7XG5pbXBvcnQgeyBBd2FpdGluZyB9IGZyb20gXCJAL21vbmFkL2F3YWl0aW5nXCI7XG5pbXBvcnQgeyBTdWNjZXNzIH0gZnJvbSBcIkAvbW9uYWQvbW9uYWRzL2VpdGhlci9zdWNjZXNzXCI7XG5pbXBvcnQgeyBGYWlsdXJlIH0gZnJvbSBcIkAvbW9uYWQvbW9uYWRzL2VpdGhlci9mYWlsdXJlXCI7XG5pbXBvcnQgaXNFcXVhbCBmcm9tIFwiZmFzdC1kZWVwLWVxdWFsXCI7XG5cbnR5cGUgQ2FsbGJhY2tzPFQ+ID0ge1xuICBvblN1Y2Nlc3M/OiAodmFsdWU6IFN1Y2Nlc3M8VD4pID0+IHZvaWQ7XG4gIG9uRmFpbHVyZT86IChlcnJvcjogRmFpbHVyZSkgPT4gdm9pZDtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VFZmZlY3RBc3luY1Jlc3VsdDxUPihcbiAgcmVzdWx0OiBBc3luY1Jlc3VsdDxUPixcbiAgeyBvblN1Y2Nlc3MsIG9uRmFpbHVyZSB9OiBDYWxsYmFja3M8VD4sXG4pOiB2b2lkIHtcbiAgY29uc3QgcHJldmlvdXNSZWYgPSB1c2VSZWY8QXN5bmNSZXN1bHQ8VD4+KG5ldyBBd2FpdGluZygpKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IHByZXZpb3VzID0gcHJldmlvdXNSZWYuY3VycmVudDtcblxuICAgIGNvbnN0IGhhc1N0YXR1c0NoYW5nZWQgPSAoKCkgPT4ge1xuICAgICAgaWYgKFxuICAgICAgICBwcmV2aW91cyBpbnN0YW5jZW9mIEF3YWl0aW5nICYmXG4gICAgICAgIChyZXN1bHQgaW5zdGFuY2VvZiBTdWNjZXNzIHx8IHJlc3VsdCBpbnN0YW5jZW9mIEZhaWx1cmUpXG4gICAgICApIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICBpZiAocHJldmlvdXMgaW5zdGFuY2VvZiBTdWNjZXNzICYmIHJlc3VsdCBpbnN0YW5jZW9mIEZhaWx1cmUpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICBpZiAocHJldmlvdXMgaW5zdGFuY2VvZiBGYWlsdXJlICYmIHJlc3VsdCBpbnN0YW5jZW9mIFN1Y2Nlc3MpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSkoKTtcblxuICAgIGNvbnN0IGhhc1ZhbHVlQ2hhbmdlZCA9XG4gICAgICByZXN1bHQgaW5zdGFuY2VvZiBTdWNjZXNzICYmXG4gICAgICBwcmV2aW91cyBpbnN0YW5jZW9mIFN1Y2Nlc3MgJiZcbiAgICAgICFpc0VxdWFsKHByZXZpb3VzLnVud3JhcCgpLCByZXN1bHQudW53cmFwKCkpO1xuXG4gICAgaWYgKGhhc1N0YXR1c0NoYW5nZWQgfHwgaGFzVmFsdWVDaGFuZ2VkKSB7XG4gICAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgU3VjY2VzcyAmJiBvblN1Y2Nlc3MpIHtcbiAgICAgICAgb25TdWNjZXNzKHJlc3VsdCk7XG4gICAgICB9XG4gICAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgRmFpbHVyZSAmJiBvbkZhaWx1cmUpIHtcbiAgICAgICAgb25GYWlsdXJlKHJlc3VsdCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcHJldmlvdXNSZWYuY3VycmVudCA9IHJlc3VsdDtcbiAgfSwgW3Jlc3VsdCwgb25TdWNjZXNzLCBvbkZhaWx1cmVdKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgdXNlRWZmZWN0QXN5bmNSZXN1bHQ7XG4iLCJpbXBvcnQgeyBBc3luY1Jlc3VsdCBhcyBBc3luY1Jlc3VsdFR5cGUgfSBmcm9tIFwiQC9tb25hZC9yZXN1bHRcIjtcbmltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHVzZUVmZmVjdEFzeW5jUmVzdWx0IGZyb20gXCJAL21vbmFkL2hvb2tzL3VzZS1lZmZlY3QtYXN5bmMtcmVzdWx0XCI7XG5pbXBvcnQgeyBGYWlsdXJlIH0gZnJvbSBcIkAvbW9uYWQvbW9uYWRzL2VpdGhlci9mYWlsdXJlXCI7XG5pbXBvcnQgeyBTdWNjZXNzIH0gZnJvbSBcIkAvbW9uYWQvbW9uYWRzL2VpdGhlci9zdWNjZXNzXCI7XG5cbnR5cGUgUHJvcHM8VD4gPSB7XG4gIGFzeW5jUmVzdWx0OiBBc3luY1Jlc3VsdFR5cGU8VD47XG4gIG9uTG9hZGluZzogUmVhY3QuUmVhY3ROb2RlO1xuICBvbkVycm9yOiAoZGF0YTogRmFpbHVyZSkgPT4gUmVhY3QuUmVhY3ROb2RlO1xuICBvblN1Y2Nlc3M6IChkYXRhOiBTdWNjZXNzPFQ+KSA9PiBSZWFjdC5SZWFjdE5vZGU7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gQXN5bmNSZXN1bHRTdXNwZW5zZTxUPih7XG4gIGFzeW5jUmVzdWx0LFxuICBvbkxvYWRpbmcsXG4gIG9uRXJyb3IsXG4gIG9uU3VjY2Vzcyxcbn06IFByb3BzPFQ+KSB7XG4gIGNvbnN0IFtkYXRhLCBzZXREYXRhXSA9IHVzZVN0YXRlPFN1Y2Nlc3M8VD4gfCBudWxsPihudWxsKTtcbiAgY29uc3QgW2Vycm9yLCBzZXRFcnJvcl0gPSB1c2VTdGF0ZTxGYWlsdXJlIHwgZmFsc2U+KGZhbHNlKTtcbiAgY29uc3QgW2xvYWRpbmcsIHNldExvYWRpbmddID0gdXNlU3RhdGU8Ym9vbGVhbj4odHJ1ZSk7XG5cbiAgdXNlRWZmZWN0QXN5bmNSZXN1bHQ8VD4oYXN5bmNSZXN1bHQsIHtcbiAgICBvblN1Y2Nlc3M6IChkYXRhKSA9PiB7XG4gICAgICBzZXREYXRhKGRhdGEpO1xuICAgICAgc2V0TG9hZGluZyhmYWxzZSk7XG4gICAgfSxcbiAgICBvbkZhaWx1cmU6IChlcnJvcikgPT4ge1xuICAgICAgc2V0RXJyb3IoZXJyb3IpO1xuICAgICAgc2V0TG9hZGluZyhmYWxzZSk7XG4gICAgfSxcbiAgfSk7XG5cbiAgaWYgKGxvYWRpbmcgfHwgIWRhdGEpIHtcbiAgICByZXR1cm4gPD57b25Mb2FkaW5nfTwvPjtcbiAgfVxuXG4gIGlmIChlcnJvcikge1xuICAgIHJldHVybiA8PntvbkVycm9yKGVycm9yKX08Lz47XG4gIH1cblxuICByZXR1cm4gPD57b25TdWNjZXNzKGRhdGEpfTwvPjtcbn1cbiJdfQ==