'use strict';

var s=class r{constructor(){this.traces=[];}static empty(){return new r}add(t){let e=new r;return e.traces=[...this.traces,t],e}*[Symbol.iterator](){for(let t of this.traces)yield t;}};var a=class r{constructor(t,e){this.message=t,this.time=e;}static from(t,e){return new r(t,e)}read(){return this.message}at(){return this.time}};var d=Symbol("JsMonadSomeSymbol"),C;C=d;var p=class p{constructor(t){this[C]=!0;this.value=t;}static of(t){return new p(t)}bind(t){return t(this.value)}unwrap(){return this.value}map(t){let e=t(this.value);return p.of(e)}},l=p;function E(r){return r&&r[d]===!0}var R=Symbol("JsMonadNoneSymbol"),g;g=R;var T=class T{constructor(){this[g]=!0;}static of(){return new T}bind(t){return this}unwrap(){throw new Error("Value of None cannot be unwrapped")}map(t){return this}},u=T;function F(r){return r&&r[R]===!0}var i=class r{constructor(){this.contexts={};}static empty(){return new r}get(t){return this.contexts[t]?l.of(this.contexts[t]):u.of()}add(t,e){let o=new r;return o.contexts={...this.contexts},o.contexts[t]=e,o}remove(t){let e=new r;return e.contexts={...this.contexts},delete e.contexts[t],e}*[Symbol.iterator](){for(let t in this.contexts)yield this.contexts[t];}};var b=Symbol("JsMonadFailureSymbol"),w;w=b;var h=class h{constructor(t,e,o,m,n){this[w]=!0;this.message=t,this.name="Failure",this.code=e,this.traces=o,this.contexts=m,this.previous=n;}static dueTo(t,e,o,m,n,x){return n=n??s.empty(),m?n.add(m):n.add(a.from(t,Date.now())),x=x??i.empty(),new h(t,e,n,x,o||null)}bind(t){return this}map(t){return this}lift(t){return this}unwrap(){throw new Error("Value of Failure can not be unwrapped")}getTraces(){return this.traces}withTrace(t){return this.traces.add(t),this}withContext(t,e){return this.contexts.add(t,e),this}getContext(t){return this.contexts.get(t)}getContexts(){return this.contexts}clearContext(t){return this.contexts.remove(t),this}},f=h;function U(r){return r&&r[b]===!0}var O=Symbol("JsMonadSuccessSymbol"),S;S=O;var c=class c{constructor(t,e,o){this[S]=!0;this.value=t,this.traces=e,this.contexts=o;}static of(t,e,o){return new c(t,e??s.empty(),o??i.empty())}bind(t){return t(this.value)}lift(t){return new c(t,this.traces,this.contexts)}map(t){return new c(t(this.value),this.traces,this.contexts)}unwrap(){return this.value}getTraces(){return this.traces}withTrace(t){return this.traces.add(t),this}withContext(t,e){return this.contexts.add(t,e),this}getContext(t){return this.contexts.get(t)}getContexts(){return this.contexts}clearContext(t){return this.contexts.remove(t),this}},y=c;function J(r){return r&&r[O]===!0}var N=Symbol("JsMonadAwaitingSymbol"),A;A=N;var v=class{constructor(){this[A]=!0;}};function M(r){return r&&r[N]===!0}

exports.Awaiting = v;
exports.ContextCollection = i;
exports.Failure = f;
exports.None = u;
exports.Some = l;
exports.Success = y;
exports.TraceCollection = s;
exports.TraceCommon = a;
exports.isAwaiting = M;
exports.isFailure = U;
exports.isNone = F;
exports.isSome = E;
exports.isSuccess = J;
//# sourceMappingURL=out.js.map
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9tb25hZC90cmFjZS90cmFjZS1jb2xsZWN0aW9uLnRzIiwiLi4vc3JjL21vbmFkL3RyYWNlL3RyYWNlLWNvbW1vbi50cyIsIi4uL3NyYy9tb25hZC9tb25hZHMvb3B0aW9uYWwvc29tZS50cyIsIi4uL3NyYy9tb25hZC9tb25hZHMvb3B0aW9uYWwvbm9uZS50cyIsIi4uL3NyYy9tb25hZC9jb250ZXh0L2NvbnRleHQtY29sbGVjdGlvbi50cyIsIi4uL3NyYy9tb25hZC9tb25hZHMvZWl0aGVyL2ZhaWx1cmUudHMiLCIuLi9zcmMvbW9uYWQvbW9uYWRzL2VpdGhlci9zdWNjZXNzLnRzIiwiLi4vc3JjL21vbmFkL2F3YWl0aW5nLnRzIl0sIm5hbWVzIjpbIlRyYWNlQ29sbGVjdGlvbiIsIl9UcmFjZUNvbGxlY3Rpb24iLCJ0cmFjZSIsIm5ld0NvbGxlY3Rpb24iLCJUcmFjZUNvbW1vbiIsIl9UcmFjZUNvbW1vbiIsIm1lc3NhZ2UiLCJ0aW1lIiwiU29tZVN5bWJvbCIsIl9hIiwiX1NvbWUiLCJ2YWx1ZSIsImZuIiwibmV3VmFsdWUiLCJTb21lIiwiaXNTb21lIiwib2JqIiwiTm9uZVN5bWJvbCIsIl9Ob25lIiwiTm9uZSIsImlzTm9uZSIsIkNvbnRleHRDb2xsZWN0aW9uIiwiX0NvbnRleHRDb2xsZWN0aW9uIiwia2V5IiwiY29udGV4dCIsIkZhaWx1cmVTeW1ib2wiLCJfRmFpbHVyZSIsImNvZGUiLCJ0cmFjZXMiLCJjb250ZXh0cyIsInByZXZpb3VzIiwiRmFpbHVyZSIsImlzRmFpbHVyZSIsIlN1Y2Nlc3NTeW1ib2wiLCJfU3VjY2VzcyIsIlN1Y2Nlc3MiLCJpc1N1Y2Nlc3MiLCJBd2FpdGluZ1N5bWJvbCIsIkF3YWl0aW5nIiwiaXNBd2FpdGluZyJdLCJtYXBwaW5ncyI6IkFBSU8sSUFBTUEsRUFBTixNQUFNQyxDQUFrQyxDQUdyQyxhQUFjLENBRnRCLEtBQVUsT0FBa0IsQ0FBQyxDQUVOLENBRXZCLE9BQWMsT0FBeUIsQ0FDckMsT0FBTyxJ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LENBQ0YsRUE5RGFZLEVBQU5ELEVBZ0VBLFNBQVNFLEVBQ2RwQixFQUNtQixDQUNuQixPQUFPQSxHQUFRQSxFQUFtQmlCLENBQWEsSUFBTSxFQUN2RCxDQzdFQSxJQUFNSSxFQUFpQixPQUFPLHVCQUF1QixFQUhyRDVCLEVBVUdBLEVBQUE0QixFQUZJLElBQU1DLEVBQU4sS0FBb0MsQ0FBcEMsY0FFTCxLQUFDN0IsR0FBa0IsR0FDckIsRUFHTyxTQUFTOEIsRUFBY3ZCLEVBQXNDLENBQ2xFLE9BQU9BLEdBQVFBLEVBQWlCcUIsQ0FBYyxJQUFNLEVBQ3REIiwic291cmNlc0NvbnRlbnQiOlsiLy8gSW1wbGVtZW50IHRoZSBUcmFjZUNvbGxlY3Rpb24gY2xhc3NcbmltcG9ydCB7IFRyYWNlcyB9IGZyb20gXCJAL21vbmFkL3RyYWNlL3RyYWNlc1wiO1xuaW1wb3J0IHsgVHJhY2UgfSBmcm9tIFwiQC9tb25hZC90cmFjZS90cmFjZVwiO1xuXG5leHBvcnQgY2xhc3MgVHJhY2VDb2xsZWN0aW9uIGltcGxlbWVudHMgVHJhY2VzIHtcbiAgcHJvdGVjdGVkIHRyYWNlczogVHJhY2VbXSA9IFtdO1xuXG4gIHByaXZhdGUgY29uc3RydWN0b3IoKSB7fVxuXG4gIHB1YmxpYyBzdGF0aWMgZW1wdHkoKTogVHJhY2VDb2xsZWN0aW9uIHtcbiAgICByZXR1cm4gbmV3IFRyYWNlQ29sbGVjdGlvbigpO1xuICB9XG5cbiAgcHVibGljIGFkZCh0cmFjZTogVHJhY2UpOiBUcmFjZUNvbGxlY3Rpb24ge1xuICAgIGNvbnN0IG5ld0NvbGxlY3Rpb24gPSBuZXcgVHJhY2VDb2xsZWN0aW9uKCk7XG4gICAgbmV3Q29sbGVjdGlvbi50cmFjZXMgPSBbLi4udGhpcy50cmFjZXMsIHRyYWNlXTtcbiAgICByZXR1cm4gbmV3Q29sbGVjdGlvbjtcbiAgfVxuXG4gIHB1YmxpYyAqW1N5bWJvbC5pdGVyYXRvcl0oKTogSXRlcmF0b3I8VHJhY2U+IHtcbiAgICBmb3IgKGNvbnN0IHRyYWNlIG9mIHRoaXMudHJhY2VzKSB7XG4gICAgICB5aWVsZCB0cmFjZTtcbiAgICB9XG4gIH1cbn1cbiIsIi8vIEltcGxlbWVudCB0aGUgVHJhY2VDb21tb24gY2xhc3NcbmltcG9ydCB7IFRyYWNlIH0gZnJvbSBcIkAvbW9uYWQvdHJhY2UvdHJhY2VcIjtcblxuZXhwb3J0IGNsYXNzIFRyYWNlQ29tbW9uIGltcGxlbWVudHMgVHJhY2Uge1xuICBwcml2YXRlIHJlYWRvbmx5IG1lc3NhZ2U6IHN0cmluZztcbiAgcHJpdmF0ZSByZWFkb25seSB0aW1lOiBudW1iZXI7XG5cbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcsIHRpbWU6IG51bWJlcikge1xuICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgdGhpcy50aW1lID0gdGltZTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgZnJvbShtZXNzYWdlOiBzdHJpbmcsIHRpbWU6IG51bWJlcik6IFRyYWNlQ29tbW9uIHtcbiAgICByZXR1cm4gbmV3IFRyYWNlQ29tbW9uKG1lc3NhZ2UsIHRpbWUpO1xuICB9XG5cbiAgcHVibGljIHJlYWQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5tZXNzYWdlO1xuICB9XG5cbiAgcHVibGljIGF0KCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMudGltZTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgT3B0aW9uYWwgfSBmcm9tIFwiQC9tb25hZC9vcHRpb25hbFwiO1xuaW1wb3J0IHsgQXN5bmNPcHRpb25hbFJlc3VsdCwgT3B0aW9uYWxSZXN1bHQgfSBmcm9tIFwiQC9tb25hZC9yZXN1bHRcIjtcbmltcG9ydCB7IE5vbmUgfSBmcm9tIFwiQC9tb25hZC9tb25hZHMvb3B0aW9uYWwvbm9uZVwiO1xuXG5jb25zdCBTb21lU3ltYm9sID0gU3ltYm9sKFwiSnNNb25hZFNvbWVTeW1ib2xcIik7XG5cbmV4cG9ydCBjbGFzcyBTb21lPFQ+IGltcGxlbWVudHMgT3B0aW9uYWw8VD4ge1xuICBwcml2YXRlIHJlYWRvbmx5IHZhbHVlOiBUO1xuXG4gIFtTb21lU3ltYm9sXSA9IHRydWU7XG5cbiAgcHJpdmF0ZSBjb25zdHJ1Y3Rvcih2YWx1ZTogVCkge1xuICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgfVxuXG4gIHN0YXRpYyBvZjxUPih2YWx1ZTogVCk6IFNvbWU8VD4ge1xuICAgIHJldHVybiBuZXcgU29tZSh2YWx1ZSk7XG4gIH1cblxuICBiaW5kPFU+KGZuOiAodmFsdWU6IFQpID0+IE9wdGlvbmFsPFU+KTogT3B0aW9uYWw8VT4ge1xuICAgIHJldHVybiBmbih0aGlzLnZhbHVlKTtcbiAgfVxuXG4gIHVud3JhcCgpOiBUIHtcbiAgICByZXR1cm4gdGhpcy52YWx1ZTtcbiAgfVxuXG4gIG1hcDxVPihmbjogKHZhbHVlOiBUKSA9PiBVKTogT3B0aW9uYWw8VT4ge1xuICAgIGNvbnN0IG5ld1ZhbHVlID0gZm4odGhpcy52YWx1ZSk7XG4gICAgcmV0dXJuIFNvbWUub2YobmV3VmFsdWUpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1NvbWU8VD4oXG4gIG9iajogT3B0aW9uYWxSZXN1bHQ8YW55PiB8IEFzeW5jT3B0aW9uYWxSZXN1bHQ8YW55Pixcbik6IG9iaiBpcyBTb21lPFQ+IHtcbiAgcmV0dXJuIG9iaiAmJiAob2JqIGFzIFNvbWU8VD4pW1NvbWVTeW1ib2xdID09PSB0cnVlO1xufVxuIiwiLy8gRGVmaW5lIHRoZSBOb25lIGNsYXNzIGltcGxlbWVudGluZyB0aGUgT3B0aW9uYWwgaW50ZXJmYWNlXG5pbXBvcnQgeyBPcHRpb25hbCB9IGZyb20gXCJAL21vbmFkL29wdGlvbmFsXCI7XG5pbXBvcnQgeyBBc3luY09wdGlvbmFsUmVzdWx0LCBPcHRpb25hbFJlc3VsdCB9IGZyb20gXCJAL21vbmFkL3Jlc3VsdFwiO1xuXG5jb25zdCBOb25lU3ltYm9sID0gU3ltYm9sKFwiSnNNb25hZE5vbmVTeW1ib2xcIik7XG5cbmV4cG9ydCBjbGFzcyBOb25lIGltcGxlbWVudHMgT3B0aW9uYWw8bmV2ZXI+IHtcbiAgW05vbmVTeW1ib2xdID0gdHJ1ZTtcblxuICBzdGF0aWMgb2YoKTogTm9uZSB7XG4gICAgcmV0dXJuIG5ldyBOb25lKCk7XG4gIH1cblxuICBiaW5kKGZuOiAodmFsdWU6IG5ldmVyKSA9PiBPcHRpb25hbDxuZXZlcj4pOiBOb25lIHtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHVud3JhcCgpOiBuZXZlciB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiVmFsdWUgb2YgTm9uZSBjYW5ub3QgYmUgdW53cmFwcGVkXCIpO1xuICB9XG5cbiAgbWFwPFU+KGZuOiAodmFsdWU6IG5ldmVyKSA9PiBVKTogTm9uZSB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzTm9uZTxUPihcbiAgb2JqOiBPcHRpb25hbFJlc3VsdDxUPiB8IEFzeW5jT3B0aW9uYWxSZXN1bHQ8VD4sXG4pOiBvYmogaXMgTm9uZSB7XG4gIHJldHVybiBvYmogJiYgKG9iaiBhcyBOb25lKVtOb25lU3ltYm9sXSA9PT0gdHJ1ZTtcbn1cbiIsImltcG9ydCB7IENvbnRleHRzIH0gZnJvbSBcIkAvbW9uYWQvY29udGV4dC9jb250ZXh0c1wiO1xuaW1wb3J0IHsgQ29udGV4dCB9IGZyb20gXCJAL21vbmFkL2NvbnRleHQvY29udGV4dFwiO1xuaW1wb3J0IHsgT3B0aW9uYWxSZXN1bHQgfSBmcm9tIFwiQC9tb25hZC9yZXN1bHRcIjtcbmltcG9ydCB7IFNvbWUgfSBmcm9tIFwiQC9tb25hZC9tb25hZHMvb3B0aW9uYWwvc29tZVwiO1xuaW1wb3J0IHsgTm9uZSB9IGZyb20gXCJAL21vbmFkL21vbmFkcy9vcHRpb25hbC9ub25lXCI7XG5cbmV4cG9ydCBjbGFzcyBDb250ZXh0Q29sbGVjdGlvbiBpbXBsZW1lbnRzIENvbnRleHRzIHtcbiAgcHJpdmF0ZSBjb250ZXh0czogeyBba2V5OiBzdHJpbmddOiBDb250ZXh0IH0gPSB7fTtcblxuICBzdGF0aWMgZW1wdHkoKTogQ29udGV4dENvbGxlY3Rpb24ge1xuICAgIHJldHVybiBuZXcgQ29udGV4dENvbGxlY3Rpb24oKTtcbiAgfVxuXG4gIGdldChrZXk6IHN0cmluZyk6IE9wdGlvbmFsUmVzdWx0PENvbnRleHQ+IHtcbiAgICByZXR1cm4gdGhpcy5jb250ZXh0c1trZXldID8gU29tZS5vZih0aGlzLmNvbnRleHRzW2tleV0pIDogTm9uZS5vZigpO1xuICB9XG5cbiAgYWRkKGtleTogc3RyaW5nLCBjb250ZXh0OiBDb250ZXh0KTogQ29udGV4dENvbGxlY3Rpb24ge1xuICAgIGNvbnN0IG5ld0NvbGxlY3Rpb24gPSBuZXcgQ29udGV4dENvbGxlY3Rpb24oKTtcbiAgICBuZXdDb2xsZWN0aW9uLmNvbnRleHRzID0geyAuLi50aGlzLmNvbnRleHRzIH07XG4gICAgbmV3Q29sbGVjdGlvbi5jb250ZXh0c1trZXldID0gY29udGV4dDtcbiAgICByZXR1cm4gbmV3Q29sbGVjdGlvbjtcbiAgfVxuXG4gIHJlbW92ZShrZXk6IHN0cmluZyk6IENvbnRleHRDb2xsZWN0aW9uIHtcbiAgICBjb25zdCBuZXdDb2xsZWN0aW9uID0gbmV3IENvbnRleHRDb2xsZWN0aW9uKCk7XG4gICAgbmV3Q29sbGVjdGlvbi5jb250ZXh0cyA9IHsgLi4udGhpcy5jb250ZXh0cyB9O1xuICAgIGRlbGV0ZSBuZXdDb2xsZWN0aW9uLmNvbnRleHRzW2tleV07XG4gICAgcmV0dXJuIG5ld0NvbGxlY3Rpb247XG4gIH1cblxuICAqW1N5bWJvbC5pdGVyYXRvcl0oKTogSXRlcmF0b3I8Q29udGV4dD4ge1xuICAgIGZvciAoY29uc3Qga2V5IGluIHRoaXMuY29udGV4dHMpIHtcbiAgICAgIHlpZWxkIHRoaXMuY29udGV4dHNba2V5XTtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCB7IEVpdGhlciB9IGZyb20gXCJAL21vbmFkL2VpdGhlclwiO1xuaW1wb3J0IHsgQXN5bmNSZXN1bHQsIE9wdGlvbmFsUmVzdWx0LCBSZXN1bHQgfSBmcm9tIFwiQC9tb25hZC9yZXN1bHRcIjtcbmltcG9ydCB7IFRyYWNlcyB9IGZyb20gXCJAL21vbmFkL3RyYWNlL3RyYWNlc1wiO1xuaW1wb3J0IHsgVHJhY2UgfSBmcm9tIFwiQC9tb25hZC90cmFjZS90cmFjZVwiO1xuaW1wb3J0IHsgQ29udGV4dHMgfSBmcm9tIFwiQC9tb25hZC9jb250ZXh0L2NvbnRleHRzXCI7XG5pbXBvcnQgeyBDb250ZXh0IH0gZnJvbSBcIkAvbW9uYWQvY29udGV4dC9jb250ZXh0XCI7XG5pbXBvcnQgeyBUcmFjZUNvbGxlY3Rpb24gfSBmcm9tIFwiQC9tb25hZC90cmFjZS90cmFjZS1jb2xsZWN0aW9uXCI7XG5pbXBvcnQgeyBUcmFjZUNvbW1vbiB9IGZyb20gXCJAL21vbmFkL3RyYWNlL3RyYWNlLWNvbW1vblwiO1xuaW1wb3J0IHsgQ29udGV4dENvbGxlY3Rpb24gfSBmcm9tIFwiQC9tb25hZC9jb250ZXh0L2NvbnRleHQtY29sbGVjdGlvblwiO1xuXG5jb25zdCBGYWlsdXJlU3ltYm9sID0gU3ltYm9sKFwiSnNNb25hZEZhaWx1cmVTeW1ib2xcIik7XG5cbmV4cG9ydCBjbGFzcyBGYWlsdXJlIGltcGxlbWVudHMgRWl0aGVyPG5ldmVyPiwgRXJyb3Ige1xuICBwcml2YXRlIHJlYWRvbmx5IHRyYWNlczogVHJhY2VzO1xuICBwcml2YXRlIHJlYWRvbmx5IGNvbnRleHRzOiBDb250ZXh0cztcbiAgbWVzc2FnZTogc3RyaW5nO1xuICBjb2RlOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbiAgcHJldmlvdXM6IEVycm9yIHwgbnVsbDtcblxuICBbRmFpbHVyZVN5bWJvbF0gPSB0cnVlO1xuXG4gIHByaXZhdGUgY29uc3RydWN0b3IoXG4gICAgbWVzc2FnZTogc3RyaW5nLFxuICAgIGNvZGU6IHN0cmluZyxcbiAgICB0cmFjZXM6IFRyYWNlcyxcbiAgICBjb250ZXh0czogQ29udGV4dHMsXG4gICAgcHJldmlvdXM6IEVycm9yIHwgbnVsbCxcbiAgKSB7XG4gICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcbiAgICB0aGlzLm5hbWUgPSBcIkZhaWx1cmVcIjtcbiAgICB0aGlzLmNvZGUgPSBjb2RlO1xuICAgIHRoaXMudHJhY2VzID0gdHJhY2VzO1xuICAgIHRoaXMuY29udGV4dHMgPSBjb250ZXh0cztcbiAgICB0aGlzLnByZXZpb3VzID0gcHJldmlvdXM7XG4gIH1cblxuICBzdGF0aWMgZHVlVG8oXG4gICAgbWVzc2FnZTogc3RyaW5nLFxuICAgIGNvZGU6IHN0cmluZyxcbiAgICBwcmV2aW91cz86IEVycm9yIHwgbnVsbCxcbiAgICB0cmFjZT86IFRyYWNlIHwgbnVsbCxcbiAgICB0cmFjZXM/OiBUcmFjZXMgfCBudWxsLFxuICAgIGNvbnRleHRzPzogQ29udGV4dHMgfCBudWxsLFxuICApOiBGYWlsdXJlIHtcbiAgICAvLyBBZGQgRmFpbHVyZSB0cmFjZXMgYXMgbGFzdCBpdGVtLlxuICAgIHRyYWNlcyA9IHRyYWNlcyA/PyBUcmFjZUNvbGxlY3Rpb24uZW1wdHkoKTtcbiAgICBpZiAodHJhY2UpIHtcbiAgICAgIHRyYWNlcy5hZGQodHJhY2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBGYWxsYmFjayB0byBhIGNvbW1vbiB0cmFjZSBvZiB0aGUgbWVzc2FnZSB3aGVuIG5vIHNwZWNpZmljIHRyYWNlIHdhcyBwcm92aWRlZC5cbiAgICAgIHRyYWNlcy5hZGQoVHJhY2VDb21tb24uZnJvbShtZXNzYWdlLCBEYXRlLm5vdygpKSk7XG4gICAgfVxuXG4gICAgY29udGV4dHMgPSBjb250ZXh0cyA/PyBDb250ZXh0Q29sbGVjdGlvbi5lbXB0eSgpO1xuICAgIHJldHVybiBuZXcgRmFpbHVyZShcbiAgICAgIG1lc3NhZ2UsXG4gICAgICBjb2RlLFxuICAgICAgdHJhY2VzLFxuICAgICAgY29udGV4dHMsXG4gICAgICBwcmV2aW91cyA/IHByZXZpb3VzIDogbnVsbCxcbiAgICApO1xuICB9XG5cbiAgYmluZChmbjogKHZhbHVlOiBuZXZlcikgPT4gUmVzdWx0PG5ldmVyPik6IFJlc3VsdDxuZXZlcj4ge1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgbWFwKGZuOiAodmFsdWU6IG5ldmVyKSA9PiBuZXZlcik6IFJlc3VsdDxuZXZlcj4ge1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgbGlmdCh2YWx1ZTogbmV2ZXIpOiBSZXN1bHQ8bmV2ZXI+IHtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHVud3JhcCgpOiBuZXZlciB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiVmFsdWUgb2YgRmFpbHVyZSBjYW4gbm90IGJlIHVud3JhcHBlZFwiKTtcbiAgfVxuXG4gIGdldFRyYWNlcygpOiBUcmFjZXMge1xuICAgIHJldHVybiB0aGlzLnRyYWNlcztcbiAgfVxuXG4gIHdpdGhUcmFjZSh0cmFjZTogVHJhY2UpOiBSZXN1bHQ8bmV2ZXI+IHtcbiAgICB0aGlzLnRyYWNlcy5hZGQodHJhY2UpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgd2l0aENvbnRleHQoa2V5OiBzdHJpbmcsIGNvbnRleHQ6IENvbnRleHQpOiBSZXN1bHQ8bmV2ZXI+IHtcbiAgICB0aGlzLmNvbnRleHRzLmFkZChrZXksIGNvbnRleHQpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgZ2V0Q29udGV4dChrZXk6IHN0cmluZyk6IE9wdGlvbmFsUmVzdWx0PENvbnRleHQ+IHtcbiAgICByZXR1cm4gdGhpcy5jb250ZXh0cy5nZXQoa2V5KTtcbiAgfVxuXG4gIGdldENvbnRleHRzKCk6IENvbnRleHRzIHtcbiAgICByZXR1cm4gdGhpcy5jb250ZXh0cztcbiAgfVxuXG4gIGNsZWFyQ29udGV4dChrZXk6IHN0cmluZyk6IFJlc3VsdDxuZXZlcj4ge1xuICAgIHRoaXMuY29udGV4dHMucmVtb3ZlKGtleSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRmFpbHVyZTxUPihvYmo6IEFzeW5jUmVzdWx0PFQ+IHwgUmVzdWx0PFQ+KTogb2JqIGlzIEZhaWx1cmUge1xuICByZXR1cm4gb2JqICYmIChvYmogYXMgRmFpbHVyZSlbRmFpbHVyZVN5bWJvbF0gPT09IHRydWU7XG59XG4iLCJpbXBvcnQgeyBFaXRoZXIgfSBmcm9tIFwiQC9tb25hZC9laXRoZXJcIjtcbmltcG9ydCB7IEFzeW5jUmVzdWx0LCBPcHRpb25hbFJlc3VsdCwgUmVzdWx0IH0gZnJvbSBcIkAvbW9uYWQvcmVzdWx0XCI7XG5pbXBvcnQgeyBDb250ZXh0cyB9IGZyb20gXCJAL21vbmFkL2NvbnRleHQvY29udGV4dHNcIjtcbmltcG9ydCB7IFRyYWNlcyB9IGZyb20gXCJAL21vbmFkL3RyYWNlL3RyYWNlc1wiO1xuaW1wb3J0IHsgVHJhY2UgfSBmcm9tIFwiQC9tb25hZC90cmFjZS90cmFjZVwiO1xuaW1wb3J0IHsgQ29udGV4dCB9IGZyb20gXCJAL21vbmFkL2NvbnRleHQvY29udGV4dFwiO1xuaW1wb3J0IHsgVHJhY2VDb2xsZWN0aW9uIH0gZnJvbSBcIkAvbW9uYWQvdHJhY2UvdHJhY2UtY29sbGVjdGlvblwiO1xuaW1wb3J0IHsgQ29udGV4dENvbGxlY3Rpb24gfSBmcm9tIFwiQC9tb25hZC9jb250ZXh0L2NvbnRleHQtY29sbGVjdGlvblwiO1xuaW1wb3J0IHsgRmFpbHVyZSB9IGZyb20gXCJAL21vbmFkL21vbmFkcy9laXRoZXIvZmFpbHVyZVwiO1xuXG5jb25zdCBTdWNjZXNzU3ltYm9sID0gU3ltYm9sKFwiSnNNb25hZFN1Y2Nlc3NTeW1ib2xcIik7XG5cbmV4cG9ydCBjbGFzcyBTdWNjZXNzPFQ+IGltcGxlbWVudHMgRWl0aGVyPFQ+IHtcbiAgcHJpdmF0ZSByZWFkb25seSB2YWx1ZTogVDtcbiAgcHJpdmF0ZSByZWFkb25seSB0cmFjZXM6IFRyYWNlcztcbiAgcHJpdmF0ZSByZWFkb25seSBjb250ZXh0czogQ29udGV4dHM7XG4gIFtTdWNjZXNzU3ltYm9sXSA9IHRydWU7XG5cbiAgcHJpdmF0ZSBjb25zdHJ1Y3Rvcih2YWx1ZTogVCwgdHJhY2VzOiBUcmFjZXMsIGNvbnRleHRzOiBDb250ZXh0cykge1xuICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICB0aGlzLnRyYWNlcyA9IHRyYWNlcztcbiAgICB0aGlzLmNvbnRleHRzID0gY29udGV4dHM7XG4gIH1cblxuICBzdGF0aWMgb2YodmFsdWU6IGFueSwgdHJhY2VzPzogVHJhY2VzIHwgbnVsbCwgY29udGV4dHM/OiBDb250ZXh0cyB8IG51bGwpIHtcbiAgICByZXR1cm4gbmV3IFN1Y2Nlc3MoXG4gICAgICB2YWx1ZSxcbiAgICAgIHRyYWNlcyA/PyBUcmFjZUNvbGxlY3Rpb24uZW1wdHkoKSxcbiAgICAgIGNvbnRleHRzID8/IENvbnRleHRDb2xsZWN0aW9uLmVtcHR5KCksXG4gICAgKTtcbiAgfVxuXG4gIGJpbmQoZm46ICh2YWx1ZTogVCkgPT4gUmVzdWx0PFQ+KTogUmVzdWx0PFQ+IHtcbiAgICByZXR1cm4gZm4odGhpcy52YWx1ZSk7XG4gIH1cblxuICBsaWZ0KHZhbHVlOiBhbnkpOiBSZXN1bHQ8VD4ge1xuICAgIHJldHVybiBuZXcgU3VjY2Vzcyh2YWx1ZSwgdGhpcy50cmFjZXMsIHRoaXMuY29udGV4dHMpO1xuICB9XG5cbiAgbWFwKGZuOiAodmFsdWU6IGFueSkgPT4gYW55KTogUmVzdWx0PFQ+IHtcbiAgICByZXR1cm4gbmV3IFN1Y2Nlc3MoZm4odGhpcy52YWx1ZSksIHRoaXMudHJhY2VzLCB0aGlzLmNvbnRleHRzKTtcbiAgfVxuXG4gIHVud3JhcCgpOiBUIHtcbiAgICByZXR1cm4gdGhpcy52YWx1ZTtcbiAgfVxuXG4gIGdldFRyYWNlcygpOiBUcmFjZXMge1xuICAgIHJldHVybiB0aGlzLnRyYWNlcztcbiAgfVxuXG4gIHdpdGhUcmFjZSh0cmFjZTogVHJhY2UpOiBSZXN1bHQ8VD4ge1xuICAgIHRoaXMudHJhY2VzLmFkZCh0cmFjZSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICB3aXRoQ29udGV4dChrZXk6IHN0cmluZywgY29udGV4dDogQ29udGV4dCk6IFJlc3VsdDxUPiB7XG4gICAgdGhpcy5jb250ZXh0cy5hZGQoa2V5LCBjb250ZXh0KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGdldENvbnRleHQoa2V5OiBzdHJpbmcpOiBPcHRpb25hbFJlc3VsdDxDb250ZXh0PiB7XG4gICAgcmV0dXJuIHRoaXMuY29udGV4dHMuZ2V0KGtleSk7XG4gIH1cblxuICBnZXRDb250ZXh0cygpOiBDb250ZXh0cyB7XG4gICAgcmV0dXJuIHRoaXMuY29udGV4dHM7XG4gIH1cblxuICBjbGVhckNvbnRleHQoa2V5OiBzdHJpbmcpOiBSZXN1bHQ8VD4ge1xuICAgIHRoaXMuY29udGV4dHMucmVtb3ZlKGtleSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzU3VjY2VzczxUPihcbiAgb2JqOiBBc3luY1Jlc3VsdDxUPiB8IFJlc3VsdDxUPixcbik6IG9iaiBpcyBTdWNjZXNzPFQ+IHtcbiAgcmV0dXJuIG9iaiAmJiAob2JqIGFzIFN1Y2Nlc3M8VD4pW1N1Y2Nlc3NTeW1ib2xdID09PSB0cnVlO1xufVxuIiwiLy8gU3RlcCAxOiBDcmVhdGUgYSB1bmlxdWUgc3ltYm9sIHRvIHRhZyB0aGUgY2xhc3NcbmltcG9ydCB7IEFzeW5jUmVzdWx0IH0gZnJvbSBcIkAvbW9uYWQvcmVzdWx0XCI7XG5cbmNvbnN0IEF3YWl0aW5nU3ltYm9sID0gU3ltYm9sKFwiSnNNb25hZEF3YWl0aW5nU3ltYm9sXCIpO1xuXG4vLyBTdGVwIDI6IERlZmluZSB0aGUgQXdhaXRpbmcgY2xhc3MgYW5kIHRhZyBpdCB3aXRoIHRoZSBzeW1ib2xcbmV4cG9ydCBpbnRlcmZhY2UgQXdhaXRpbmdJIHt9XG5cbmV4cG9ydCBjbGFzcyBBd2FpdGluZyBpbXBsZW1lbnRzIEF3YWl0aW5nSSB7XG4gIC8vIFRhZ2dpbmcgdGhlIGNsYXNzIHdpdGggdGhlIHN5bWJvbFxuICBbQXdhaXRpbmdTeW1ib2xdID0gdHJ1ZTtcbn1cblxuLy8gUmV0dXJucyAnVHJ1ZScgd2hlbiBvbmUgdmFsdWUgaXMgaW5zdGFuY2Ugb2YgQXdhaXRpbmcuXG5leHBvcnQgZnVuY3Rpb24gaXNBd2FpdGluZzxUPihvYmo6IEFzeW5jUmVzdWx0PFQ+KTogb2JqIGlzIEF3YWl0aW5nIHtcbiAgcmV0dXJuIG9iaiAmJiAob2JqIGFzIEF3YWl0aW5nKVtBd2FpdGluZ1N5bWJvbF0gPT09IHRydWU7XG59XG4iXX0=